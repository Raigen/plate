{"version":3,"file":"index.es.js","sources":["../src/AddThreadToolbarButton.tsx","../src/determineAbsolutePosition.tsx","../src/Thread/Contacts.tsx","../src/Thread/Thread.styles.ts","../node_modules/@babel/runtime/helpers/extends.js","../../../../../node_modules/@babel/runtime/helpers/extends.js","../../../../../node_modules/@babel/runtime/helpers/defineProperty.js","../../../../../node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","../../../../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js","../../../../../node_modules/@emotion/memoize/dist/memoize.browser.esm.js","../../../../../node_modules/@emotion/is-prop-valid/dist/is-prop-valid.browser.esm.js","../../../../../node_modules/@styled-icons/styled-icon/index.esm.js","../node_modules/@styled-icons/material/Check/Check.esm.js","../node_modules/@styled-icons/material/Unarchive/Unarchive.esm.js","../node_modules/@styled-icons/material/Close/Close.esm.js","../src/ThreadLinkDialog/ThreadLinkDialog.styles.ts","../src/ThreadLinkDialog/ThreadLinkDialog.tsx","../node_modules/@styled-icons/material/MoreVert/MoreVert.esm.js","../src/Thread/ThreadComment/MenuButton.styles.ts","../src/Thread/ThreadComment/MenuButton.tsx","../src/Thread/ThreadComment/ThreadComment.styles.ts","../src/Thread/ThreadComment/ThreadCommentEditing.tsx","../src/Thread/ThreadComment/ThreadComment.tsx","../src/Thread/Thread.tsx","../src/Threads/Threads.styles.ts","../src/Threads/Threads.tsx","../src/ToggleShowThreadsButton.tsx","../src/ThreadElement/ThreadElement.styles.ts","../src/ThreadElement/ThreadElement.tsx","../src/SideThread/SideThread.styles.ts","../src/SideThread/SideThread.tsx","../src/useComments.tsx"],"sourcesContent":["import React from 'react';\nimport {\n  useEventPlateId,\n  usePlateEditorState,\n  withPlateEventProvider,\n} from '@udecode/plate-core';\nimport { ToolbarButton, ToolbarButtonProps } from '@udecode/plate-ui-toolbar';\n\nexport const AddThreadToolbarButton = withPlateEventProvider(\n  ({ id, onAddThread, ...props }: ToolbarButtonProps) => {\n    id = useEventPlateId(id);\n    const editor = usePlateEditorState(id)!;\n\n    return (\n      <ToolbarButton\n        onMouseDown={(event) => {\n          if (!editor) {\n            return;\n          }\n\n          event.preventDefault();\n          onAddThread();\n        }}\n        {...props}\n      />\n    );\n  }\n);\n","export function determineAbsolutePosition(element: HTMLElement) {\n  let left = 0;\n  let top = 0;\n  let currentElement: HTMLElement | null = element;\n  do {\n    left += currentElement.offsetLeft || 0;\n    top += currentElement.offsetTop || 0;\n    currentElement = currentElement.offsetParent as HTMLElement;\n  } while (currentElement);\n  return {\n    left,\n    top,\n  };\n}\n","import '@material/list/dist/mdc.list.css';\nimport '@material/menu/dist/mdc.menu.css';\nimport React, { RefObject } from 'react';\nimport { Corner, DefaultFocusState, MDCMenu } from '@material/menu';\nimport { Contact } from '@udecode/plate-comments';\n\ninterface ContactsProps {\n  contacts: Contact[];\n  onSelected: (contact: Contact) => void;\n  onClosed: () => void;\n  selectedIndex: number;\n}\n\nexport class Contacts extends React.Component<ContactsProps> {\n  contactsRef: RefObject<HTMLDivElement>;\n  contactsMenu?: MDCMenu;\n\n  constructor(props: ContactsProps) {\n    super(props);\n\n    this.contactsRef = React.createRef();\n\n    this.onMenuSelected = this.onMenuSelected.bind(this);\n  }\n\n  componentDidMount() {\n    this.contactsMenu = new MDCMenu(this.contactsRef.current!);\n    this.contactsMenu.setDefaultFocusState(DefaultFocusState.NONE);\n    this.contactsMenu.setAnchorCorner(Corner.BOTTOM_START);\n\n    const { onClosed } = this.props;\n    this.contactsMenu.listen('MDCMenu:selected', this.onMenuSelected);\n    this.contactsMenu.listen('MDCMenuSurface:closed', onClosed);\n\n    this.contactsMenu.open = true;\n  }\n\n  componentWillUnmount() {\n    this.contactsMenu!.unlisten('MDCMenu:selected', this.onMenuSelected);\n    const { onClosed } = this.props;\n    this.contactsMenu!.unlisten('MDCMenuSurface:closed', onClosed);\n    this.contactsMenu!.destroy();\n  }\n\n  onMenuSelected(event: CustomEvent) {\n    const { contacts } = this.props;\n    const selectedContactIndex = event.detail.index;\n    const selectedContact = contacts[selectedContactIndex];\n    const { onSelected } = this.props;\n    onSelected(selectedContact);\n  }\n\n  render() {\n    const { contacts, selectedIndex } = this.props;\n\n    return (\n      <div ref={this.contactsRef} className=\"mdc-menu mdc-menu-surface\">\n        <ul\n          className=\"mdc-list mdc-menu__selection-group\"\n          role=\"menu\"\n          aria-hidden=\"true\"\n          aria-orientation=\"vertical\"\n          tabIndex={-1}\n        >\n          {contacts.map(({ name, email, avatarUrl }, index) => (\n            <li\n              key={email}\n              className={`mdc-list-item mdc-list-item--with-two-lines mdc-list-item--with-leading-avatar${\n                index === selectedIndex ? ' mdc-list-item--selected' : ''\n              }`}\n              tabIndex={index === selectedIndex ? 0 : -1}\n            >\n              <span className=\"mdc-list-item__ripple\" />\n              <span className=\"mdc-list-item__start\">\n                <img src={avatarUrl} alt=\"Avatar\" width={40} height={40} />\n              </span>\n              <span className=\"mdc-list-item__content\">\n                <span className=\"mdc-list-item__primary-text\">{name}</span>\n                <span className=\"mdc-list-item__secondary-text\">{email}</span>\n              </span>\n            </li>\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n","import { createStyles, StyledProps } from '@udecode/plate-styled-components';\nimport { css, CSSProp } from 'styled-components';\n\nexport const createThreadStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'Thread',\n      ...props,\n    },\n    {\n      root: css`\n        border-radius: 8px;\n        box-shadow: 0 2px 6px 2px rgb(60 64 67 / 15%);\n        background-color: white;\n      `,\n    }\n  );\n\nexport const createCommentHeaderStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadCommentHeader',\n      ...props,\n    },\n    {\n      root: css`\n        box-sizing: content-box;\n        font-weight: normal;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        text-align: left;\n        color: black;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        font-size: 14px;\n        direction: ltr;\n        cursor: default;\n        -webkit-user-select: text;\n        height: 38px;\n        white-space: nowrap;\n        display: flex;\n        margin: 0;\n        padding: 12px;\n        align-items: center;\n      `,\n    }\n  );\n\nexport const createAvatarHolderStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadAvatarHolder',\n      ...props,\n    },\n    {\n      root: css`\n        font-weight: normal;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        text-align: left;\n        color: black;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        font-size: 14px;\n        direction: ltr;\n        cursor: default;\n        -webkit-user-select: text;\n        white-space: nowrap;\n        height: 38px;\n        margin-top: 2px;\n        max-width: 36px;\n        width: 36px;\n      `,\n    }\n  );\n\nexport const createCommentProfileImageStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadCommentProfileImage',\n      ...props,\n    },\n    {\n      root: css`\n        font-weight: normal;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        text-align: left;\n        color: black;\n        font-size: 14px;\n        direction: ltr;\n        cursor: default;\n        -webkit-user-select: text;\n        white-space: nowrap;\n        width: 32px;\n        aspect-ratio: auto 32 / 32;\n        height: 32px;\n        object-fit: cover;\n        left: 0 !important;\n        display: block;\n        position: relative;\n        border-radius: 50%;\n        margin-left: 2px;\n        margin-top: 2px;\n      `,\n    }\n  );\n\nexport const createAuthorTimestampStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadAuthorTimestamp',\n      ...props,\n    },\n    {\n      root: css`\n        font-weight: normal;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        text-align: left;\n        color: black;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        font-size: 14px;\n        cursor: pointer;\n        direction: ltr;\n        -webkit-user-select: text;\n        padding-left: 10px;\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n        -webkit-box-flex: 1;\n        flex-grow: 1;\n        display: flex;\n        align-items: start;\n        flex-direction: column;\n        justify-content: center;\n      `,\n    }\n  );\n\nexport const createCommenterNameStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadCommenterName',\n      ...props,\n    },\n    {\n      root: css`\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        text-align: left;\n        direction: ltr;\n        cursor: default;\n        -webkit-user-select: text;\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin: 0;\n        height: 18px;\n        align-self: stretch;\n        color: #3c4043;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        font-weight: 500;\n        font-size: 14px;\n        letter-spacing: 0.25px;\n        line-height: 20px;\n        margin-right: 0.25rem;\n      `,\n    }\n  );\n\nexport const createTimestampStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadTimestamp',\n      ...props,\n    },\n    {\n      root: css`\n        color: #3c4043;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        font-size: 12px;\n        line-height: 16px;\n        letter-spacing: 0.3px;\n      `,\n    }\n  );\n\nexport const createCommentInputStyles = (props: StyledProps) =>\n  createStyles<StyledProps<{ commentInputReply: CSSProp }>>(\n    {\n      prefixClassNames: 'ThreadCommentInput',\n      ...props,\n    } as any,\n    {\n      root: css`\n        font-weight: normal;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        color: black;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        white-space: normal;\n        font-size: 14px;\n        cursor: default;\n        -webkit-user-select: text;\n        direction: ltr;\n        unicode-bidi: isolate;\n        position: relative;\n        outline: none;\n        zoom: 1;\n        border: none;\n        background-color: #fff;\n        padding: 12px;\n        display: block !important;\n        padding-top: 0;\n        text-align: left;\n      `,\n      commentInputReply: css`\n        border-top: 1px solid rgb(218, 220, 224);\n        padding-top: 12px;\n        margin-top: 12px;\n      `,\n    }\n  );\n\nexport const createTextAreaStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadTextArea',\n      ...props,\n    },\n    {\n      root: css`\n        color: #3c4043;\n        line-height: 20px;\n        height: 38px;\n        border: 1px solid #dadce0;\n        border-radius: 4px;\n        box-sizing: border-box;\n        font-size: 14px;\n        min-height: 36px;\n        padding: 8px;\n        display: block;\n        margin: 0;\n        overflow-x: hidden;\n        overflow-y: hidden;\n        outline-width: 0 !important;\n        resize: none;\n        width: 100%;\n        cursor: text;\n        text-align: start;\n        word-wrap: break-word;\n      `,\n    }\n  );\n\nexport const createButtonsStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadButtons',\n      ...props,\n    },\n    {\n      root: css`\n        font-weight: normal;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        color: black;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        white-space: normal;\n        font-size: 14px;\n        cursor: pointer;\n        direction: ltr;\n        -webkit-user-select: text;\n        zoom: 1;\n        text-align: left;\n        padding-top: 8px;\n        display: block;\n      `,\n    }\n  );\n\nexport const createCommentButtonStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadCommentButton',\n      ...props,\n    },\n    {\n      root: css`\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        direction: ltr;\n        position: relative;\n        display: inline-block;\n        text-align: center;\n        white-space: nowrap;\n        outline: 0px;\n        margin: 0 8px 0 0;\n        min-width: 24px;\n        vertical-align: middle;\n        border: 1px solid transparent !important;\n        border-radius: 4px;\n        box-shadow: none;\n        box-sizing: border-box;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        font-weight: 500;\n        font-size: 14px;\n        letter-spacing: 0.25px;\n        line-height: 16px;\n        height: 24px;\n        padding: 3px 12px 5px;\n        background-color: #1a73e8;\n        color: #fff;\n        user-select: none;\n        cursor: pointer;\n\n        &:hover {\n          background-color: #2b7de9;\n          box-shadow: 0 1px 3px 1px rgb(66 133 244 / 15%);\n          color: #fff;\n        }\n\n        &:active {\n          background-color: #63a0ef;\n          box-shadow: 0 2px 6px 2px rgb(66 133 244 / 15%);\n          color: #fff;\n        }\n      `,\n    }\n  );\n\nexport const createCancelButtonStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadCommentButton',\n      ...props,\n    },\n    {\n      root: css`\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n        direction: ltr;\n        position: relative;\n        display: inline-block;\n        text-align: center;\n        white-space: nowrap;\n        outline: 0px;\n        margin: 0 8px 0 0;\n        min-width: 24px;\n        vertical-align: middle;\n        border-radius: 4px;\n        box-shadow: none;\n        box-sizing: border-box;\n        font-weight: 500;\n        font-size: 14px;\n        letter-spacing: 0.25px;\n        line-height: 16px;\n        background: white;\n        border: 1px solid #dadce0 !important;\n        height: 24px;\n        padding: 3px 12px 5px;\n        color: #1a73e8;\n        user-select: none;\n        cursor: pointer;\n\n        &:hover {\n          background-color: #f8fbff;\n          border-color: #cce0fc !important;\n        }\n\n        &:active {\n          background-color: #e1ecfe;\n          color: #1a73e8;\n        }\n\n        &:hover:active {\n          box-shadow: 0 2px 6px 2px rgb(60 64 67 / 15%);\n        }\n      `,\n    }\n  );\n","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose.js\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function memoize(fn) {\n  var cache = {};\n  return function (arg) {\n    if (cache[arg] === undefined) cache[arg] = fn(arg);\n    return cache[arg];\n  };\n}\n\nexport default memoize;\n","import memoize from '@emotion/memoize';\n\nvar reactPropsRegex = /^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|inert|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/; // https://esbench.com/bench/5bfee68a4cd7e6009ef61d23\n\nvar index = memoize(function (prop) {\n  return reactPropsRegex.test(prop) || prop.charCodeAt(0) === 111\n  /* o */\n  && prop.charCodeAt(1) === 110\n  /* n */\n  && prop.charCodeAt(2) < 91;\n}\n/* Z+1 */\n);\n\nexport default index;\n","import _extends from \"@babel/runtime/helpers/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as React from 'react';\nimport styled from 'styled-components';\nimport validProp from '@emotion/is-prop-valid';\n\nfunction isValidProp(key) {\n  return validProp(key);\n}\n\nfunction filterSVGProps(props) {\n  return Object.keys(props).reduce(function (p, k) {\n    if (isValidProp(k)) {\n      // hack to satisfy TypeScript complexity\n      ;\n      p[k] = props[k];\n    }\n\n    return p;\n  }, {});\n}\n\nvar StyledIconBaseBase = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var children = props.children,\n      iconAttrs = props.iconAttrs,\n      iconVerticalAlign = props.iconVerticalAlign,\n      iconViewBox = props.iconViewBox,\n      size = props.size,\n      title = props.title,\n      otherProps = _objectWithoutProperties(props, [\"children\", \"iconAttrs\", \"iconVerticalAlign\", \"iconViewBox\", \"size\", \"title\"]);\n\n  var iconProps = _objectSpread({\n    viewBox: iconViewBox,\n    height: props.height !== undefined ? props.height : size,\n    width: props.width !== undefined ? props.width : size,\n    'aria-hidden': title == null ? 'true' : undefined,\n    focusable: 'false',\n    role: title != null ? 'img' : undefined\n  }, iconAttrs);\n\n  var svgProps = filterSVGProps(otherProps);\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({}, iconProps, svgProps, {\n    ref: ref\n  }), title && /*#__PURE__*/React.createElement(\"title\", {\n    key: \"icon-title\"\n  }, title), children);\n});\nexport var StyledIconBase = /*#__PURE__*/styled(StyledIconBaseBase).withConfig({\n  displayName: \"StyledIconBase\",\n  componentId: \"ea9ulj-0\"\n})([\"display:inline-block;vertical-align:\", \";overflow:hidden;\"], function (props) {\n  return props.iconVerticalAlign;\n});","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Check = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"none\",\n    d: \"M0 0h24v24H0z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"\n  }));\n});\nCheck.displayName = 'Check';\nexport var CheckDimensions = {\n  height: 24,\n  width: 24\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Unarchive = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    width: 24,\n    height: 24,\n    fill: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20.55 5.22l-1.39-1.68A1.51 1.51 0 0018 3H6c-.47 0-.88.21-1.15.55L3.46 5.22C3.17 5.57 3 6.01 3 6.5V19a2 2 0 002 2h14c1.1 0 2-.9 2-2V6.5c0-.49-.17-.93-.45-1.28zM12 9.5l5.5 5.5H14v2h-4v-2H6.5L12 9.5zM5.12 5l.82-1h12l.93 1H5.12z\"\n  }));\n});\nUnarchive.displayName = 'Unarchive';\nexport var UnarchiveDimensions = {\n  height: 24,\n  width: 24\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Close = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"none\",\n    d: \"M0 0h24v24H0z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n  }));\n});\nClose.displayName = 'Close';\nexport var CloseDimensions = {\n  height: 24,\n  width: 24\n};","import { createStyles, StyledProps } from '@udecode/plate-styled-components';\nimport { css } from 'styled-components';\n\nexport const createCloseButtonStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadLinkDialogCloseButton',\n      ...props,\n    },\n    {\n      root: css`\n        width: 32px;\n        height: 32px;\n        padding: 7px;\n\n        svg {\n          position: relative;\n          top: -6px;\n          width: 18px;\n          height: 18px;\n        }\n      `,\n    }\n  );\n","import '@material/button/dist/mdc.button.css';\nimport '@material/dialog/dist/mdc.dialog.css';\nimport '@material/notched-outline/dist/mdc.notched-outline.css';\nimport '@material/textfield/dist/mdc.textfield.css';\nimport '@material/snackbar/dist/mdc.snackbar.css';\nimport '@material/icon-button/dist/mdc.icon-button.css';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { MDCDialog } from '@material/dialog';\nimport { MDCRipple } from '@material/ripple';\nimport { MDCSnackbar } from '@material/snackbar';\n// eslint-disable-next-line no-restricted-imports\nimport { Close } from '@styled-icons/material/Close';\nimport { StyledProps } from '@udecode/plate-styled-components';\nimport { createCloseButtonStyles } from './ThreadLinkDialog.styles';\n\ninterface CommentLinkDialogProps extends StyledProps {\n  threadLink: string;\n  onClose: () => void;\n}\n\nexport class ThreadLinkDialog extends React.Component<CommentLinkDialogProps> {\n  ref: React.RefObject<HTMLDivElement>;\n  inputRef: React.RefObject<HTMLInputElement>;\n  snackbarRef: React.RefObject<HTMLElement>;\n  doneButtonRef: React.RefObject<HTMLButtonElement>;\n  copyLinkButtonRef: React.RefObject<HTMLButtonElement>;\n  dialog?: MDCDialog;\n  snackbar?: MDCSnackbar;\n  closeButton: any;\n\n  constructor(props: CommentLinkDialogProps) {\n    super(props);\n    this.ref = React.createRef();\n    this.inputRef = React.createRef();\n    this.snackbarRef = React.createRef();\n    this.doneButtonRef = React.createRef();\n    this.copyLinkButtonRef = React.createRef();\n    this.onCopyLink = this.onCopyLink.bind(this);\n    const { root: closeButton } = createCloseButtonStyles(props);\n    this.closeButton = closeButton;\n  }\n\n  componentDidMount() {\n    this.dialog = new MDCDialog(this.ref.current!);\n    new MDCRipple(this.doneButtonRef.current!);\n    new MDCRipple(this.copyLinkButtonRef.current!);\n    this.inputRef.current!.select();\n    this.snackbar = new MDCSnackbar(this.snackbarRef.current!);\n  }\n\n  async onCopyLink() {\n    const { threadLink } = this.props;\n    await navigator.clipboard.writeText(threadLink);\n    this.snackbar!.open();\n    this.inputRef.current!.select();\n  }\n\n  render() {\n    const { threadLink, onClose } = this.props;\n\n    return ReactDOM.createPortal(\n      <div\n        ref={this.ref}\n        className=\"mdc-dialog mdc-dialog--open mdc-dialog--fullscreen\"\n      >\n        <div className=\"mdc-dialog__container\">\n          <div\n            className=\"mdc-dialog__surface\"\n            role=\"alertdialog\"\n            aria-modal=\"true\"\n            aria-labelledby=\"comment-link-dialog-title\"\n            aria-describedby=\"comment-link-dialog-content\"\n          >\n            <div className=\"mdc-dialog__header\">\n              <h2 className=\"mdc-dialog__title\" id=\"comment-link-dialog-title\">\n                Link to thread\n              </h2>\n              <button\n                css={this.closeButton.css}\n                type=\"button\"\n                className={`${this.closeButton.className} mdc-icon-button mdc-dialog__close`}\n                data-mdc-dialog-action=\"close\"\n                onClick={onClose}\n              >\n                <div className=\"mdc-icon-button__ripple\" />\n                <Close />\n              </button>\n            </div>\n            <div\n              className=\"mdc-dialog__content\"\n              id=\"comment-link-dialog-content\"\n            >\n              <label\n                className=\"mdc-text-field mdc-text-field--outlined mdc-text-field--no-label\"\n                style={{ width: '100%' }}\n              >\n                <span className=\"mdc-notched-outline\">\n                  <span className=\"mdc-notched-outline__leading\" />\n                  <span className=\"mdc-notched-outline__trailing\" />\n                </span>\n                <input\n                  ref={this.inputRef}\n                  className=\"mdc-text-field__input\"\n                  type=\"text\"\n                  aria-label=\"Comment link\"\n                  defaultValue={threadLink}\n                  readOnly\n                />\n              </label>\n\n              <aside\n                ref={this.snackbarRef}\n                className=\"mdc-snackbar\"\n                style={{ bottom: '0.5rem' }}\n              >\n                <div\n                  className=\"mdc-snackbar__surface\"\n                  role=\"status\"\n                  aria-relevant=\"additions\"\n                >\n                  <div className=\"mdc-snackbar__label\" aria-atomic=\"false\">\n                    The link has been copied to the clipboard.\n                  </div>\n                </div>\n              </aside>\n            </div>\n            <div className=\"mdc-dialog__actions\">\n              <button\n                ref={this.doneButtonRef}\n                type=\"button\"\n                className=\"mdc-button mdc-dialog__button\"\n                data-mdc-dialog-action=\"done\"\n                onClick={onClose}\n              >\n                <div className=\"mdc-button__ripple\" />\n                <span className=\"mdc-button__label\">Done</span>\n              </button>\n              <button\n                ref={this.copyLinkButtonRef}\n                type=\"button\"\n                className=\"mdc-button mdc-dialog__button\"\n                data-mdc-dialog-action=\"copy-link\"\n                onClick={this.onCopyLink}\n              >\n                <div className=\"mdc-button__ripple\" />\n                <span className=\"mdc-button__label\">Copy link</span>\n              </button>\n            </div>\n          </div>\n        </div>\n        <div className=\"mdc-dialog__scrim\" />\n      </div>,\n      document.body\n    );\n  }\n}\n","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var MoreVert = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"none\",\n    d: \"M0 0h24v24H0z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"\n  }));\n});\nMoreVert.displayName = 'MoreVert';\nexport var MoreVertDimensions = {\n  height: 24,\n  width: 24\n};","import { createStyles, StyledProps } from '@udecode/plate-styled-components';\nimport { css } from 'styled-components';\n\nexport function createMoreButtonStyles(props: StyledProps) {\n  return createStyles(\n    {\n      prefixClassNames: 'ThreadMoreButton',\n      ...props,\n    },\n    {\n      root: css`\n        padding: 3px;\n        width: 30px;\n        height: 30px;\n\n        & .mdc-icon-button__ripple::before,\n        & .mdc-icon-button__ripple::after {\n          border-radius: initial;\n        }\n\n        svg {\n          position: relative;\n          top: -3px;\n        }\n      `,\n    }\n  );\n}\n","import '@material/icon-button/dist/mdc.icon-button.css';\nimport '@material/list/dist/mdc.list.css';\nimport '@material/menu-surface/dist/mdc.menu-surface.css';\nimport '@material/menu/dist/mdc.menu.css';\nimport React from 'react';\nimport { MDCMenu } from '@material/menu';\n// eslint-disable-next-line no-restricted-imports\nimport { MoreVert } from '@styled-icons/material/MoreVert';\nimport { StyledProps } from '@udecode/plate-styled-components';\nimport { createMoreButtonStyles } from './MenuButton.styles';\n\nexport interface MenuButtonProps extends StyledProps {\n  showLinkToThisComment: boolean;\n  onEdit: () => void;\n  onDelete: () => void;\n  onLinkToThisComment: () => void;\n}\n\nexport class MenuButton extends React.Component<MenuButtonProps> {\n  ref: React.RefObject<HTMLDivElement>;\n  menu?: MDCMenu;\n  button: any;\n\n  constructor(props: MenuButtonProps) {\n    super(props);\n    this.ref = React.createRef();\n    this.onClick = this.onClick.bind(this);\n    const { root: button } = createMoreButtonStyles(props);\n    this.button = button;\n  }\n\n  componentDidMount() {\n    this.menu = new MDCMenu(this.ref.current!);\n  }\n\n  onClick() {\n    this.menu!.open = !this.menu!.open;\n  }\n\n  render() {\n    const {\n      showLinkToThisComment,\n      onEdit,\n      onDelete,\n      onLinkToThisComment,\n    } = this.props;\n\n    return (\n      <div className=\"mdc-menu-surface--anchor\">\n        <button\n          type=\"button\"\n          css={this.button.css}\n          className={`${this.button.className} mdc-icon-button`}\n          onClick={this.onClick}\n        >\n          <div className=\"mdc-icon-button__ripple\" />\n          <MoreVert />\n        </button>\n        <div ref={this.ref} className=\"mdc-menu mdc-menu-surface\">\n          <ul\n            className=\"mdc-list\"\n            role=\"menu\"\n            aria-hidden=\"true\"\n            aria-orientation=\"vertical\"\n            tabIndex={-1}\n          >\n            <li className=\"mdc-list-item\" role=\"menuitem\" onClick={onEdit}>\n              <span className=\"mdc-list-item__ripple\" />\n              <span className=\"mdc-list-item__text\">Edit</span>\n            </li>\n            <li className=\"mdc-list-item\" role=\"menuitem\" onClick={onDelete}>\n              <span className=\"mdc-list-item__ripple\" />\n              <span className=\"mdc-list-item__text\">Delete</span>\n            </li>\n            <li\n              className=\"mdc-list-item\"\n              role=\"menuitem\"\n              onClick={onLinkToThisComment}\n              style={{ display: showLinkToThisComment ? 'block' : 'none' }}\n            >\n              <span className=\"mdc-list-item__ripple\" />\n              <span className=\"mdc-list-item__text\">Link to this thread</span>\n            </li>\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n","import { createStyles, StyledProps } from '@udecode/plate-styled-components';\nimport { css } from 'styled-components';\n\nexport function createThreadCommentStyled(props: StyledProps) {\n  return createStyles(\n    {\n      prefixClassNames: 'ThreadComment',\n      ...props,\n    },\n    {\n      root: css``,\n    }\n  );\n}\n\nexport function createResolveThreadButtonStyles(props: StyledProps) {\n  return createStyles(\n    {\n      prefixClassNames: 'ThreadResolveThreadButton',\n      ...props,\n    },\n    {\n      root: css`\n        padding: 3px;\n        width: 30px;\n        height: 30px;\n\n        & .mdc-icon-button__ripple::before,\n        & .mdc-icon-button__ripple::after {\n          border-radius: initial;\n        }\n\n        svg {\n          position: relative;\n          top: -3px;\n        }\n      `,\n    }\n  );\n}\n\nexport function createReOpenThreadButtonStyles(props: StyledProps) {\n  return createStyles(\n    {\n      prefixClassNames: 'ThreadResolveThreadButton',\n      ...props,\n    },\n    {\n      root: css`\n        padding: 3px;\n        width: 30px;\n        height: 30px;\n\n        & .mdc-icon-button__ripple::before,\n        & .mdc-icon-button__ripple::after {\n          border-radius: initial;\n        }\n\n        svg {\n          position: relative;\n          top: -3px;\n        }\n      `,\n    }\n  );\n}\n\nexport function createThreadCommentTextStyles(props: StyledProps) {\n  return createStyles(\n    {\n      prefixClassNames: 'ThreadCommentText',\n      ...props,\n    },\n    {\n      root: css`\n        padding-left: 12px;\n        padding-right: 12px;\n        font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n      `,\n    }\n  );\n}\n","import React, { useCallback, useEffect, useRef } from 'react';\nimport { StyledProps } from '@udecode/plate-styled-components';\nimport {\n  createButtonsStyles,\n  createCancelButtonStyles,\n  createCommentButtonStyles,\n  createCommentInputStyles,\n  createTextAreaStyles,\n} from '../Thread.styles';\n\nexport function ThreadCommentEditing({\n  defaultText,\n  onSave: onSaveCallback,\n  onCancel,\n  ...props\n}: {\n  defaultText: string;\n  onSave: (text: string) => void;\n  onCancel: () => void;\n} & StyledProps) {\n  const textAreaRef = useRef<HTMLTextAreaElement>(null);\n\n  const { root: commentInput } = createCommentInputStyles(props);\n  const { root: textArea } = createTextAreaStyles(props);\n  const { root: buttons } = createButtonsStyles(props);\n  const { root: commentButton } = createCommentButtonStyles(props);\n  const { root: cancelButton } = createCancelButtonStyles(props);\n\n  const onSave = useCallback(\n    function onSave() {\n      onSaveCallback(textAreaRef.current!.value);\n    },\n    [onSaveCallback, textAreaRef]\n  );\n\n  useEffect(\n    function focus() {\n      textAreaRef.current!.focus();\n    },\n    [textAreaRef]\n  );\n\n  return (\n    <div css={commentInput.css} className={commentInput.className}>\n      <textarea\n        ref={textAreaRef}\n        rows={1}\n        css={textArea.css}\n        className={textArea.className}\n        defaultValue={defaultText}\n      />\n      <div css={buttons.css} className={buttons.className}>\n        <button\n          type=\"button\"\n          css={commentButton.css}\n          className={commentButton.className}\n          onClick={onSave}\n        >\n          Save\n        </button>\n        <button\n          type=\"button\"\n          css={cancelButton.css}\n          className={cancelButton.className}\n          onClick={onCancel}\n        >\n          Cancel\n        </button>\n      </div>\n    </div>\n  );\n}\n","import '@material/menu-surface/dist/mdc.menu-surface.css';\nimport React, { useCallback, useState } from 'react';\n// eslint-disable-next-line no-restricted-imports\nimport { Check } from '@styled-icons/material/Check';\n// eslint-disable-next-line no-restricted-imports\nimport { Unarchive } from '@styled-icons/material/Unarchive';\nimport { Comment, generateThreadLink, Thread } from '@udecode/plate-comments';\nimport { StyledProps } from '@udecode/plate-styled-components';\nimport { ThreadLinkDialog } from '../../ThreadLinkDialog';\nimport {\n  createAuthorTimestampStyles,\n  createAvatarHolderStyles,\n  createCommenterNameStyles,\n  createCommentHeaderStyles,\n  createCommentProfileImageStyles,\n  createTimestampStyles,\n} from '../Thread.styles';\nimport { MenuButton } from './MenuButton';\nimport {\n  createReOpenThreadButtonStyles,\n  createResolveThreadButtonStyles,\n  createThreadCommentStyled,\n  createThreadCommentTextStyles,\n} from './ThreadComment.styles';\nimport { ThreadCommentEditing } from './ThreadCommentEditing';\n\nexport function ThreadComment(\n  props: {\n    comment: Comment;\n    thread: Thread;\n    showResolveThreadButton: boolean;\n    showReOpenThreadButton: boolean;\n    showMoreButton: boolean;\n    showLinkToThisComment: boolean;\n    onResolveThread: () => void;\n    onReOpenThread: () => void;\n    onDelete: (comment: Comment) => void;\n  } & StyledProps\n) {\n  const {\n    comment,\n    thread,\n    showResolveThreadButton,\n    showReOpenThreadButton,\n    showMoreButton,\n    showLinkToThisComment,\n    onResolveThread,\n    onReOpenThread,\n    onDelete: onDeleteCallback,\n  } = props;\n\n  const [isEdited, setIsEdited] = useState(false);\n\n  const { root } = createThreadCommentStyled(props);\n  const { root: commentHeader } = createCommentHeaderStyles(props);\n  const { root: avatarHolder } = createAvatarHolderStyles(props);\n  const { root: commentProfileImage } = createCommentProfileImageStyles(props);\n  const { root: authorTimestamp } = createAuthorTimestampStyles(props);\n  const { root: commenterName } = createCommenterNameStyles(props);\n  const { root: timestamp } = createTimestampStyles(props);\n  const { root: resolveThreadButton } = createResolveThreadButtonStyles(props);\n  const { root: reOpenThreadButton } = createReOpenThreadButtonStyles(props);\n  const { root: threadCommentText } = createThreadCommentTextStyles(props);\n\n  const [threadLink, setThreadLink] = useState<string | null>(null);\n\n  const onEdit = useCallback(function onEdit() {\n    setIsEdited(true);\n  }, []);\n\n  const onDelete = useCallback(\n    function onDelete() {\n      onDeleteCallback(comment);\n    },\n    [comment, onDeleteCallback]\n  );\n\n  const onLinkToThisComment = useCallback(\n    function onLinkToThisComment() {\n      setThreadLink(generateThreadLink(thread));\n    },\n    [thread]\n  );\n\n  const onCloseCommentLinkDialog = useCallback(\n    function onCloseCommentLinkDialog() {\n      setThreadLink(null);\n    },\n    []\n  );\n\n  const onSave = useCallback(\n    function onSave(text: string) {\n      comment.text = text; // FIXME\n      setIsEdited(false);\n    },\n    [comment]\n  );\n\n  const onCancel = useCallback(function onCancel() {\n    setIsEdited(false);\n  }, []);\n\n  return (\n    <div css={root.css} className={root.className}>\n      <div css={commentHeader.css} className={commentHeader.className}>\n        <div css={avatarHolder.css} className={avatarHolder.className}>\n          <img\n            src=\"https://upload.wikimedia.org/wikipedia/commons/5/59/User-avatar.svg\"\n            alt=\"Profile\"\n            width={32}\n            height={32}\n            css={commentProfileImage.css}\n            className={commentProfileImage.className}\n          />\n        </div>\n        <div css={authorTimestamp.css} className={authorTimestamp.className}>\n          <div css={commenterName.css} className={commenterName.className}>\n            Jon Doe\n          </div>\n          <div css={timestamp.css} className={timestamp.className}>\n            {comment.createdAt.toLocaleString()}\n          </div>\n        </div>\n        {showResolveThreadButton ? (\n          <button\n            type=\"button\"\n            css={resolveThreadButton.css}\n            className={`${resolveThreadButton.className} mdc-icon-button`}\n            onClick={onResolveThread}\n          >\n            <div className=\"mdc-icon-button__ripple\" />\n            <Check style={{ color: '#2196f3' }} />\n          </button>\n        ) : null}\n        {showReOpenThreadButton ? (\n          <button\n            type=\"button\"\n            css={reOpenThreadButton.css}\n            className={`${reOpenThreadButton.className} mdc-icon-button`}\n            onClick={onReOpenThread}\n          >\n            <div className=\"mdc-icon-button__ripple\" />\n            <Unarchive />\n          </button>\n        ) : null}\n        {showMoreButton ? (\n          <MenuButton\n            showLinkToThisComment={showLinkToThisComment}\n            onEdit={onEdit}\n            onDelete={onDelete}\n            onLinkToThisComment={onLinkToThisComment}\n          />\n        ) : null}\n      </div>\n      {isEdited ? (\n        <ThreadCommentEditing\n          defaultText={comment.text}\n          onSave={onSave}\n          onCancel={onCancel}\n        />\n      ) : (\n        <div\n          css={threadCommentText.css}\n          className={threadCommentText.className}\n        >\n          {comment.text}\n        </div>\n      )}\n      {threadLink ? (\n        <ThreadLinkDialog\n          threadLink={threadLink}\n          onClose={onCloseCommentLinkDialog}\n        />\n      ) : null}\n    </div>\n  );\n}\n","import React, {\n  KeyboardEvent,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport {\n  Comment,\n  Contact,\n  deleteThreadAtSelection,\n  doesContactMatchString,\n  findThreadNodeEntries,\n  isFirstComment,\n  Thread as ThreadModel,\n  ThreadNode,\n  upsertThread,\n} from '@udecode/plate-comments';\nimport { usePlateEditorRef } from '@udecode/plate-core';\nimport { StyledProps } from '@udecode/plate-styled-components';\nimport { Transforms } from 'slate';\nimport { FetchContacts } from '../FetchContacts';\nimport { Contacts } from './Contacts';\nimport {\n  createAuthorTimestampStyles,\n  createAvatarHolderStyles,\n  createButtonsStyles,\n  createCancelButtonStyles,\n  createCommentButtonStyles,\n  createCommenterNameStyles,\n  createCommentHeaderStyles,\n  createCommentInputStyles,\n  createCommentProfileImageStyles,\n  createTextAreaStyles,\n  createThreadStyles,\n} from './Thread.styles';\nimport { ThreadComment } from './ThreadComment';\n\nexport interface ThreadProps extends StyledProps {\n  thread: ThreadModel;\n  showResolveThreadButton: boolean;\n  showReOpenThreadButton: boolean;\n  showMoreButton: boolean;\n  onSubmitComment: (comment: Comment) => void;\n  onCancelCreateThread: () => void;\n  fetchContacts: FetchContacts;\n}\n\nexport function Thread({\n  thread,\n  showResolveThreadButton,\n  showReOpenThreadButton,\n  showMoreButton,\n  onSubmitComment: onSubmitCommentCallback,\n  onCancelCreateThread,\n  fetchContacts,\n  ...props\n}: ThreadProps) {\n  const editor = usePlateEditorRef();\n  const textAreaRef = useRef<HTMLTextAreaElement | null>(null);\n  const [areContactsShown, setAreContactsShown] = useState<boolean>(false);\n  const [contacts, setContacts] = useState<Contact[]>([]);\n  const [filteredContacts, setFilteredContacts2] = useState<Contact[]>([]);\n  const [haveContactsBeenClosed, setHaveContactsBeenClosed] = useState<boolean>(\n    false\n  );\n  const [selectedContactIndex, setSelectedContactIndex] = useState<number>(0);\n\n  const retrieveMentionStringAtCaretPosition = useCallback(\n    function retrieveMentionStringAtCaretPosition() {\n      const textArea = textAreaRef.current!;\n\n      function isMentionStringNextToCaret(\n        indexOfLastCharacterOfMentionString: number\n      ): boolean {\n        return (\n          indexOfLastCharacterOfMentionString > textArea.selectionStart ||\n          textArea.selectionStart - indexOfLastCharacterOfMentionString === 1\n        );\n      }\n\n      const { value } = textArea;\n      const mentionStringStartIndex = value\n        .substr(0, textArea.selectionStart)\n        .indexOf('@');\n      if (mentionStringStartIndex !== -1) {\n        const mentionRegExp = /@(?:\\w+ ?\\w* ?)?/;\n        const match = mentionRegExp.exec(value);\n        if (match) {\n          const indexOfLastCharacterOfMentionString =\n            mentionRegExp.lastIndex + match[0].length - 1;\n          if (isMentionStringNextToCaret(indexOfLastCharacterOfMentionString)) {\n            const mentionString = match[0].trim();\n            const mentionStringEndIndex =\n              mentionStringStartIndex + mentionString.length;\n            return {\n              string: mentionString,\n              startIndex: mentionStringStartIndex,\n              endIndex: mentionStringEndIndex,\n            };\n          }\n        }\n      }\n      return null;\n    },\n    [textAreaRef]\n  );\n\n  const retrieveMentionStringAfterAtCharacter = useCallback(\n    function retrieveMentionStringAfterAtCharacter(): string | null {\n      const mentionString = retrieveMentionStringAtCaretPosition();\n      return mentionString ? mentionString.string.substr(1) : null;\n    },\n    [retrieveMentionStringAtCaretPosition]\n  );\n\n  const filterContacts = useCallback(\n    function filterContacts(contacts2: Contact[]) {\n      const mentionStringAfterAtCharacter = retrieveMentionStringAfterAtCharacter();\n      let newFilteredContacts;\n      if (mentionStringAfterAtCharacter) {\n        newFilteredContacts = contacts2.filter(\n          doesContactMatchString.bind(null, mentionStringAfterAtCharacter)\n        );\n      } else {\n        newFilteredContacts = contacts2;\n      }\n      return newFilteredContacts;\n    },\n    [retrieveMentionStringAfterAtCharacter]\n  );\n\n  const setFilteredContacts = useCallback(\n    function setFilteredContacts(filteredContacts2) {\n      setFilteredContacts2(filteredContacts2);\n      setSelectedContactIndex(\n        Math.min(selectedContactIndex, filteredContacts2.length - 1)\n      );\n    },\n    [selectedContactIndex]\n  );\n\n  const updateFilteredContacts = useCallback(\n    function updateFilteredContacts() {\n      setFilteredContacts(filterContacts(contacts));\n    },\n    [contacts, filterContacts, setFilteredContacts]\n  );\n\n  const onSubmitComment = useCallback(\n    function onSubmitComment() {\n      const newComment = {\n        id: Math.floor(Math.random() * 1000), // FIXME\n        text: textAreaRef.current!.value,\n        createdAt: new Date(),\n      };\n      onSubmitCommentCallback(newComment);\n    },\n    [onSubmitCommentCallback]\n  );\n\n  const hasComments = useCallback(\n    function hasComments() {\n      return thread.comments.length >= 1;\n    },\n    [thread]\n  );\n\n  const clearTextArea = useCallback(\n    function clearTextArea() {\n      textAreaRef.current!.value = '';\n    },\n    [textAreaRef]\n  );\n\n  const onCancel = useCallback(\n    function onCancel() {\n      if (hasComments()) {\n        clearTextArea();\n      }\n\n      onCancelCreateThread();\n    },\n    [hasComments, onCancelCreateThread, clearTextArea]\n  );\n\n  const onResolveThread = useCallback(\n    function onResolveThread() {\n      thread.isResolved = true;\n      upsertThread(editor, thread);\n    },\n    [editor, thread]\n  );\n\n  const onReOpenThread = useCallback(\n    function onReOpenThread() {\n      thread.isResolved = false;\n      const threadNodeEntry = Array.from(findThreadNodeEntries(editor)).find(\n        (threadNodeEntry2: any) => threadNodeEntry2[0].thread === thread\n      );\n      if (threadNodeEntry) {\n        Transforms.setNodes<ThreadNode>(\n          editor,\n          {\n            thread: { ...thread },\n          },\n          { at: threadNodeEntry[1] }\n        );\n      }\n    },\n    [editor, thread]\n  );\n\n  const deleteThread = useCallback(\n    function deleteThread() {\n      deleteThreadAtSelection(editor);\n    },\n    [editor]\n  );\n\n  const deleteComment = useCallback(\n    function deleteComment(comment) {\n      thread.comments = thread.comments.filter(\n        (comment2) => comment2 !== comment\n      );\n      upsertThread(editor, thread);\n    },\n    [editor, thread]\n  );\n\n  const onDelete = useCallback(\n    function onDelete(comment: Comment) {\n      if (isFirstComment(thread, comment)) {\n        deleteThread();\n      } else {\n        deleteComment(comment);\n      }\n    },\n    [deleteComment, deleteThread, thread]\n  );\n\n  const showContacts = useCallback(\n    function showContacts() {\n      if (!haveContactsBeenClosed) {\n        setAreContactsShown(true);\n      }\n    },\n    [haveContactsBeenClosed]\n  );\n\n  const hideContacts = useCallback(function hideContacts() {\n    setAreContactsShown(false);\n    setSelectedContactIndex(0);\n  }, []);\n\n  const insertMention = useCallback(\n    function insertMention(mentionedContact) {\n      const mentionString = retrieveMentionStringAtCaretPosition();\n      if (mentionString) {\n        const textArea = textAreaRef.current!;\n        const { value } = textArea;\n        const mentionInsertString = `@${mentionedContact.email} `;\n        textArea.value = `${value.substr(\n          0,\n          mentionString.startIndex\n        )}${mentionInsertString}${value.substr(mentionString.endIndex + 1)}`;\n        const selectionIndex =\n          mentionString.startIndex + mentionInsertString.length;\n        textArea.focus();\n        textArea.setSelectionRange(selectionIndex, selectionIndex);\n      }\n    },\n    [retrieveMentionStringAtCaretPosition]\n  );\n\n  const onContactSelected = useCallback(\n    function onContactSelected(selectedContact: Contact) {\n      hideContacts();\n      insertMention(selectedContact);\n    },\n    [insertMention, hideContacts]\n  );\n\n  const onKeyDown = useCallback(\n    function onKeyDown(event: KeyboardEvent<HTMLTextAreaElement>) {\n      if (event.key === '@' && !areContactsShown) {\n        showContacts();\n      }\n\n      if (event.code === 'ArrowUp') {\n        event.preventDefault();\n        setSelectedContactIndex(Math.max(0, selectedContactIndex - 1));\n      } else if (event.code === 'ArrowDown') {\n        setSelectedContactIndex(\n          Math.min(selectedContactIndex + 1, filteredContacts.length - 1)\n        );\n      } else if (event.code === 'Enter') {\n        const selectedContact = filteredContacts[selectedContactIndex];\n        onContactSelected(selectedContact);\n        event.preventDefault();\n      }\n    },\n    [\n      areContactsShown,\n      showContacts,\n      selectedContactIndex,\n      filteredContacts,\n      onContactSelected,\n    ]\n  );\n\n  const onKeyUp = useCallback(\n    function onKeyUp() {\n      setHaveContactsBeenClosed(false);\n\n      updateFilteredContacts();\n\n      const mentionStringAfterAtCharacter = retrieveMentionStringAfterAtCharacter();\n      if (\n        mentionStringAfterAtCharacter !== null &&\n        (mentionStringAfterAtCharacter === '' ||\n          contacts.some(\n            doesContactMatchString.bind(null, mentionStringAfterAtCharacter)\n          ))\n      ) {\n        if (!areContactsShown) {\n          showContacts();\n        }\n      } else {\n        hideContacts();\n      }\n    },\n    [\n      updateFilteredContacts,\n      retrieveMentionStringAfterAtCharacter,\n      contacts,\n      areContactsShown,\n      showContacts,\n      hideContacts,\n    ]\n  );\n\n  const onContactsClosed = useCallback(function onContactsClosed() {\n    setHaveContactsBeenClosed(true);\n  }, []);\n\n  useEffect(\n    function onShow() {\n      const textArea = textAreaRef.current!;\n      textArea.value = '';\n      if (thread.comments.length === 0) {\n        textArea.focus();\n      }\n    },\n    [textAreaRef, thread]\n  );\n\n  useEffect(\n    function loadContacts() {\n      async function loadContacts2() {\n        const contacts2 = await fetchContacts();\n        setContacts(contacts2);\n        setFilteredContacts(filterContacts(contacts2));\n      }\n\n      loadContacts2();\n    },\n    [fetchContacts, filterContacts, setFilteredContacts]\n  );\n\n  const { root } = createThreadStyles(props);\n  const { root: commentHeader } = createCommentHeaderStyles(props);\n  const { root: avatarHolder } = createAvatarHolderStyles(props);\n  const { root: commentProfileImage } = createCommentProfileImageStyles(props);\n  const { root: authorTimestamp } = createAuthorTimestampStyles(props);\n  const { root: commenterName } = createCommenterNameStyles(props);\n  const { root: commentInput, commentInputReply } = createCommentInputStyles(\n    props\n  );\n  const { root: textArea } = createTextAreaStyles(props);\n  const { root: buttons } = createButtonsStyles(props);\n  const { root: commentButton } = createCommentButtonStyles(props);\n  const { root: cancelButton } = createCancelButtonStyles(props);\n\n  let commentInputCss = [...commentInput.css];\n  let commentInputClassName = commentInput.className;\n  if (hasComments()) {\n    commentInputCss = commentInputCss.concat(commentInputReply!.css);\n    commentInputClassName += ` ${commentInputReply!.className}`;\n  }\n\n  return (\n    <div css={root.css} className={root.className}>\n      {thread.comments.map((comment: Comment, index) => (\n        <ThreadComment\n          key={comment.id}\n          comment={comment}\n          thread={thread}\n          showResolveThreadButton={showResolveThreadButton && index === 0}\n          showReOpenThreadButton={showReOpenThreadButton}\n          showMoreButton={showMoreButton}\n          showLinkToThisComment={index === 0}\n          onResolveThread={onResolveThread}\n          onReOpenThread={onReOpenThread}\n          onDelete={onDelete}\n        />\n      ))}\n\n      <div>\n        {!hasComments && (\n          <div css={commentHeader.css} className={commentHeader.className}>\n            <div css={avatarHolder.css} className={avatarHolder.className}>\n              <img\n                src=\"https://upload.wikimedia.org/wikipedia/commons/5/59/User-avatar.svg\"\n                alt=\"Profile\"\n                width={32}\n                height={32}\n                css={commentProfileImage.css}\n                className={commentProfileImage.className}\n              />\n            </div>\n            <div\n              css={authorTimestamp.css}\n              className={authorTimestamp.className}\n            >\n              <div css={commenterName.css} className={commenterName.className}>\n                Jon Doe\n              </div>\n            </div>\n          </div>\n        )}\n        <div css={commentInputCss} className={commentInputClassName}>\n          <div className=\"mdc-menu-surface--anchor\">\n            <textarea\n              ref={textAreaRef}\n              rows={1}\n              css={textArea.css}\n              className={textArea.className}\n              onKeyDown={onKeyDown}\n              onKeyUp={onKeyUp}\n              placeholder={`${\n                hasComments() ? 'Reply' : 'Comment'\n              } or add others with @`}\n            />\n            {areContactsShown && (\n              <Contacts\n                contacts={filteredContacts}\n                onSelected={onContactSelected}\n                onClosed={onContactsClosed}\n                selectedIndex={selectedContactIndex}\n              />\n            )}\n          </div>\n          <div css={buttons.css} className={buttons.className}>\n            <button\n              type=\"button\"\n              css={commentButton.css}\n              className={commentButton.className}\n              onClick={onSubmitComment}\n            >\n              {thread.comments.length === 0 ? 'Comment' : 'Reply'}\n            </button>\n            <button\n              type=\"button\"\n              css={cancelButton.css}\n              className={cancelButton.className}\n              onClick={onCancel}\n            >\n              Cancel\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { createStyles, StyledProps } from '@udecode/plate-styled-components';\nimport { css } from 'styled-components';\n\nexport const createThreadsStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'Threads',\n      ...props,\n    },\n    {\n      root: css`\n        background-color: white;\n        border-radius: 8px;\n        width: 24rem;\n        height: 24rem;\n        position: absolute;\n        box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 4px 0px;\n        display: flex;\n        flex-direction: column;\n      `,\n    }\n  );\n\nexport const createHeaderStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadsHeader',\n      ...props,\n    },\n    {\n      root: css`\n        border-bottom: 1px solid rgb(218, 220, 224);\n        padding: 1rem;\n        flex: 0 0 auto;\n\n        h2 {\n          font-family: Roboto, RobotoDraft, Helvetica, Arial, sans-serif;\n          font-weight: 500;\n          font-size: 1rem;\n          margin-top: 0;\n          margin-bottom: 0;\n        }\n      `,\n    }\n  );\n\nexport const createBodyStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'ThreadsBody',\n      ...props,\n    },\n    {\n      root: css`\n        flex: 1 1 auto;\n        padding: 1rem;\n        overflow-y: auto;\n\n        & > * {\n          margin-bottom: 1rem;\n        }\n\n        & > *:last-child {\n          margin-bottom: 0;\n        }\n      `,\n    }\n  );\n","import React, {\n  RefObject,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport { findThreadNodeEntries } from '@udecode/plate-comments';\nimport { usePlateEditorRef } from '@udecode/plate-core';\nimport { StyledProps } from '@udecode/plate-styled-components';\nimport { determineAbsolutePosition } from '../determineAbsolutePosition';\nimport { FetchContacts } from '../FetchContacts';\nimport { Thread } from '../Thread';\nimport {\n  createBodyStyles,\n  createHeaderStyles,\n  createThreadsStyles,\n} from './Threads.styles';\n\nfunction wasClickOnTargetInsideThreads(event: MouseEvent): boolean {\n  const closestThreadsParent =\n    event.target &&\n    (event.target as any).closest &&\n    (event.target as any).closest('.threads');\n  return Boolean(closestThreadsParent);\n}\n\nexport function Threads(\n  props: {\n    parent: RefObject<HTMLElement>;\n    onClose: () => void;\n    fetchContacts: FetchContacts;\n  } & StyledProps\n) {\n  const editor = usePlateEditorRef();\n  const { parent, onClose, fetchContacts } = props;\n  const ref = useRef<HTMLDivElement>(null);\n  const [position, setPosition] = useState<{\n    left: number;\n    top: number;\n  } | null>(null);\n\n  useEffect(\n    function () {\n      const parentElement = parent.current!;\n      const newPosition = determineAbsolutePosition(parentElement);\n      newPosition.top += parentElement.clientHeight;\n      newPosition.left =\n        newPosition.left -\n        0.5 * ref.current!.clientWidth +\n        0.5 * parentElement.clientWidth;\n      setPosition(newPosition);\n    },\n    [parent]\n  );\n\n  const { root } = createThreadsStyles(props);\n  const { root: header } = createHeaderStyles(props);\n  const { root: body } = createBodyStyles(props);\n\n  const threadNodeEntries = Array.from(findThreadNodeEntries(editor));\n  const threads = threadNodeEntries.map(\n    (threadNodeEntry) => threadNodeEntry[0].thread\n  );\n  const resolvedThreads = threads.filter((thread) => thread.isResolved);\n\n  const onClick = useCallback(\n    function onClick(event: MouseEvent) {\n      if (!wasClickOnTargetInsideThreads(event)) {\n        onClose();\n      }\n    },\n    [onClose]\n  );\n\n  useEffect(\n    function registerOnClick() {\n      let isMounted = true;\n\n      setTimeout(() => {\n        if (isMounted) {\n          document.body.addEventListener('click', onClick);\n        }\n      }, 400);\n\n      return () => {\n        document.body.removeEventListener('click', onClick);\n        isMounted = false;\n      };\n    },\n    [onClick]\n  );\n\n  return ReactDOM.createPortal(\n    <div\n      ref={ref}\n      css={root.css}\n      className={`${root.className} threads`}\n      style={{ ...position }}\n    >\n      <div css={header.css} className={header.className}>\n        <h2>Resolved threads</h2>\n      </div>\n      <div css={body.css} className={body.className}>\n        {resolvedThreads.map((thread) => {\n          return (\n            <Thread\n              key={thread.id}\n              thread={thread}\n              onSubmitComment={() => {}}\n              onCancelCreateThread={() => {}}\n              showResolveThreadButton={false}\n              showReOpenThreadButton\n              showMoreButton={false}\n              fetchContacts={fetchContacts}\n            />\n          );\n        })}\n      </div>\n    </div>,\n    document.body\n  );\n}\n","import React, { useCallback, useRef, useState } from 'react';\nimport {\n  useEventPlateId,\n  usePlateEditorState,\n  withPlateEventProvider,\n} from '@udecode/plate-core';\nimport { ToolbarButton, ToolbarButtonProps } from '@udecode/plate-ui-toolbar';\nimport { Threads } from './Threads/Threads';\n\nexport const ToggleShowThreadsButton = withPlateEventProvider(\n  ({ id, onAddThread, fetchContacts, ...props }: ToolbarButtonProps) => {\n    id = useEventPlateId(id);\n    const editor = usePlateEditorState(id)!;\n\n    const ref = useRef<HTMLDivElement>(null);\n\n    const [areThreadsShown, setAreThreadsShown] = useState(false);\n\n    const toggleShowThreads = useCallback(\n      function showThreads() {\n        setAreThreadsShown(!areThreadsShown);\n      },\n      [areThreadsShown]\n    );\n\n    const onCloseThreads = useCallback(function onCloseThreads() {\n      setAreThreadsShown(false);\n    }, []);\n\n    return (\n      <div ref={ref}>\n        <ToolbarButton\n          active={areThreadsShown}\n          onMouseDown={(event) => {\n            if (!editor) {\n              return;\n            }\n\n            event.preventDefault();\n            toggleShowThreads();\n          }}\n          {...props}\n        />\n        {areThreadsShown ? (\n          <Threads\n            parent={ref}\n            onClose={onCloseThreads}\n            fetchContacts={fetchContacts}\n          />\n        ) : null}\n      </div>\n    );\n  }\n);\n","import {\n  createStyles,\n  StyledElementProps,\n  StyledProps,\n} from '@udecode/plate-styled-components';\nimport { css, CSSProp } from 'styled-components';\n\nexport const createThreadElementStyles = (props: StyledElementProps) =>\n  createStyles<StyledProps<{ selected: CSSProp; resolved: CSSProp }>>(\n    {\n      prefixClassNames: 'ThreadElement',\n      ...props,\n    } as any,\n    {\n      root: css`\n        background-color: #fee9ae;\n      `,\n      selected: css`\n        background-color: #fcc934;\n      `,\n      resolved: css`\n        background-color: initial !important;\n      `,\n    }\n  );\n","import React from 'react';\nimport { Thread, ThreadNodeData } from '@udecode/plate-comments';\nimport {\n  getRootProps,\n  StyledElementProps,\n} from '@udecode/plate-styled-components';\nimport { createThreadElementStyles } from './ThreadElement.styles';\n\nfunction determineStyle(\n  element: any,\n  thread: Thread,\n  props: StyledElementProps<ThreadNodeData>\n): any {\n  let style = null;\n  const { root, selected, resolved } = createThreadElementStyles(props);\n  if (thread.isResolved) {\n    style = resolved;\n  } else if (element.selected) {\n    style = selected;\n  } else {\n    style = root;\n  }\n  return style;\n}\n\nexport const ThreadElement = (props: StyledElementProps<ThreadNodeData>) => {\n  const { attributes, children, nodeProps, element } = props;\n  const { thread } = element;\n\n  const rootProps = getRootProps(props);\n  const style = determineStyle(element, thread, props);\n\n  return (\n    <span\n      {...attributes}\n      css={style.css}\n      className={style.className}\n      {...rootProps}\n      {...nodeProps}\n    >\n      {children}\n    </span>\n  );\n};\n","import { createStyles, StyledProps } from '@udecode/plate-styled-components';\nimport { css } from 'styled-components';\n\nexport const createSideThreadStyles = (props: StyledProps) =>\n  createStyles(\n    {\n      prefixClassNames: 'SideThread',\n      ...props,\n    },\n    {\n      root: css`\n        position: absolute;\n        z-index: 6;\n        width: 418px;\n      `,\n    }\n  );\n","import React from 'react';\nimport { Comment, Thread as ThreadModel } from '@udecode/plate-comments';\nimport { StyledProps } from '@udecode/plate-styled-components';\nimport { FetchContacts } from '../FetchContacts';\nimport { Thread } from '../Thread';\nimport { createSideThreadStyles } from './SideThread.styles';\n\ninterface SideThreadProps extends StyledProps {\n  thread: ThreadModel;\n  onSubmitComment: (comment: Comment) => void;\n  onCancelCreateThread: () => void;\n  fetchContacts: FetchContacts;\n  position: { left: number; top: number };\n}\n\nexport function SideThread({ position, ...props }: SideThreadProps) {\n  const { root } = createSideThreadStyles(props);\n\n  return (\n    <div\n      css={root.css}\n      className={root.className}\n      style={{\n        left: position.left,\n        top: position.top,\n      }}\n    >\n      <Thread\n        {...props}\n        showResolveThreadButton\n        showReOpenThreadButton={false}\n        showMoreButton\n      />\n    </div>\n  );\n}\n","import { useCallback, useEffect, useState } from 'react';\nimport {\n  Comment,\n  deleteThread,\n  ELEMENT_THREAD,\n  findThreadNodeEntries,\n  Thread,\n  upsertThread,\n} from '@udecode/plate-comments';\nimport {\n  getAbove,\n  getPluginType,\n  usePlateEditorState,\n} from '@udecode/plate-core';\nimport { NodeEntry, Transforms } from 'slate';\nimport { ReactEditor } from 'slate-react';\nimport { determineAbsolutePosition } from './determineAbsolutePosition';\n\nexport interface UseCommentsResult {\n  thread: Thread | null;\n  show: boolean;\n  position: {\n    left: number;\n    top: number;\n  };\n  onSubmitComment: (comment: Comment) => void;\n  onAddThread: () => void;\n}\n\nexport function useComments(): any {\n  const editor = usePlateEditorState();\n  const [thread, setThread] = useState<Thread | null>(null);\n  const [threadPosition, setThreadPosition] = useState({ left: 0, top: 0 });\n  const [\n    newThreadThreadNodeEntry,\n    setNewThreadThreadNodeEntry,\n  ] = useState<NodeEntry | null>(null);\n\n  const updateThreadPosition = useCallback(\n    function updateThreadPosition(threadNodeEntry) {\n      const selectionDOMNode = ReactEditor.toDOMNode(\n        editor,\n        threadNodeEntry[0]\n      );\n      const selectionDOMNodePosition = determineAbsolutePosition(\n        selectionDOMNode\n      );\n\n      const editorDOMNode = ReactEditor.toDOMNode(editor, editor);\n      const {\n        x: editorX,\n        width: editorWidth,\n      } = editorDOMNode.getBoundingClientRect();\n\n      const newThreadPosition = {\n        left: editorX + editorWidth + 16,\n        top: selectionDOMNodePosition.top,\n      };\n      setThreadPosition(newThreadPosition);\n    },\n    [editor]\n  );\n\n  const showThread = useCallback(\n    function showThread(threadNodeEntry: any) {\n      const { thread: selectedThread } = threadNodeEntry[0];\n      requestAnimationFrame(() => {\n        updateThreadPosition(threadNodeEntry);\n        setThread(selectedThread);\n      });\n    },\n    [updateThreadPosition]\n  );\n\n  const hideThread = useCallback(function hideThread() {\n    setThread(null);\n  }, []);\n\n  const onCancelCreateThread = useCallback(\n    function onCancelCreateThread() {\n      if (newThreadThreadNodeEntry) {\n        deleteThread(editor, newThreadThreadNodeEntry[1]);\n        setNewThreadThreadNodeEntry(null);\n      }\n    },\n    [editor, newThreadThreadNodeEntry]\n  );\n\n  useEffect(\n    function handleThreadIdInURL() {\n      const url = new URL(window.location.href);\n      const threadIdQueryParam = url.searchParams.get('thread');\n      if (threadIdQueryParam) {\n        const threadId = parseInt(threadIdQueryParam, 10);\n        const threadNodeEntries = Array.from(findThreadNodeEntries(editor));\n        const threadNodeEntry = threadNodeEntries.find(\n          (threadNodeEntry2: any) => threadNodeEntry2[0].thread.id === threadId\n        );\n        if (threadNodeEntry) {\n          ReactEditor.focus(editor);\n          Transforms.select(editor, threadNodeEntry[1]);\n          Transforms.collapse(editor, { edge: 'start' });\n          showThread(threadNodeEntry);\n\n          const domNode = ReactEditor.toDOMNode(editor, threadNodeEntry[0]);\n          domNode.scrollIntoView();\n\n          window.addEventListener('load', () => {\n            updateThreadPosition(threadNodeEntry);\n          });\n        }\n      }\n    },\n    [editor, showThread, updateThreadPosition]\n  );\n\n  useEffect(\n    function onEditorChange() {\n      const type = getPluginType(editor, ELEMENT_THREAD);\n      // FIXME: Show thread when putting caret before the first character of the text with which the thread is connected.\n      const threadNodeEntry = getAbove(editor, {\n        match: { type },\n      });\n      const isThreadNodeTheNewThreadNode =\n        threadNodeEntry &&\n        newThreadThreadNodeEntry &&\n        threadNodeEntry[0].id === (newThreadThreadNodeEntry[0] as any).id;\n      if (!isThreadNodeTheNewThreadNode) {\n        onCancelCreateThread();\n      }\n      if (threadNodeEntry && !threadNodeEntry[0].thread.isResolved) {\n        showThread(threadNodeEntry);\n      } else {\n        hideThread();\n      }\n    },\n    [\n      editor.selection,\n      showThread,\n      hideThread,\n      editor,\n      newThreadThreadNodeEntry,\n      onCancelCreateThread,\n    ]\n  );\n\n  const onAddThread = useCallback(\n    function onAddThread() {\n      if (editor.selection) {\n        const newThread: Thread = {\n          id: Math.floor(Math.random() * 1000), // FIXME\n          comments: [],\n          isResolved: false,\n        };\n        const newThreadThreadNodeEntry2 = upsertThread(editor, newThread);\n        setNewThreadThreadNodeEntry(newThreadThreadNodeEntry2);\n      }\n    },\n    [editor]\n  );\n\n  const onSubmitComment = useCallback(\n    function onSubmitComment(comment: Comment) {\n      thread!.comments.push(comment);\n      upsertThread(editor, thread!);\n      setNewThreadThreadNodeEntry(null);\n      setThread(null);\n    },\n    [editor, thread]\n  );\n\n  return {\n    thread,\n    position: threadPosition,\n    onAddThread,\n    onSubmitComment,\n    onCancelCreateThread,\n  };\n}\n"],"names":["AddThreadToolbarButton","withPlateEventProvider","id","onAddThread","props","useEventPlateId","editor","usePlateEditorState","React","event","preventDefault","determineAbsolutePosition","element","left","top","currentElement","offsetLeft","offsetTop","offsetParent","Contacts","Component","constructor","contactsRef","createRef","onMenuSelected","bind","componentDidMount","contactsMenu","MDCMenu","current","setDefaultFocusState","DefaultFocusState","NONE","setAnchorCorner","Corner","BOTTOM_START","onClosed","listen","open","componentWillUnmount","unlisten","destroy","contacts","selectedContactIndex","detail","index","selectedContact","onSelected","render","selectedIndex","map","name","email","avatarUrl","createThreadStyles","createStyles","prefixClassNames","root","css","createCommentHeaderStyles","createAvatarHolderStyles","createCommentProfileImageStyles","createAuthorTimestampStyles","createCommenterNameStyles","createTimestampStyles","createCommentInputStyles","commentInputReply","createTextAreaStyles","createButtonsStyles","createCommentButtonStyles","createCancelButtonStyles","validProp","styled","_extends","createCloseButtonStyles","ThreadLinkDialog","ref","inputRef","snackbarRef","doneButtonRef","copyLinkButtonRef","onCopyLink","closeButton","dialog","MDCDialog","MDCRipple","select","snackbar","MDCSnackbar","threadLink","navigator","clipboard","writeText","onClose","ReactDOM","createPortal","className","width","bottom","document","body","createMoreButtonStyles","MenuButton","onClick","button","menu","showLinkToThisComment","onEdit","onDelete","onLinkToThisComment","display","createThreadCommentStyled","createResolveThreadButtonStyles","createReOpenThreadButtonStyles","createThreadCommentTextStyles","ThreadCommentEditing","defaultText","onSave","onSaveCallback","onCancel","textAreaRef","useRef","commentInput","textArea","buttons","commentButton","cancelButton","useCallback","value","useEffect","focus","ThreadComment","comment","thread","showResolveThreadButton","showReOpenThreadButton","showMoreButton","onResolveThread","onReOpenThread","onDeleteCallback","isEdited","setIsEdited","useState","commentHeader","avatarHolder","commentProfileImage","authorTimestamp","commenterName","timestamp","resolveThreadButton","reOpenThreadButton","threadCommentText","setThreadLink","generateThreadLink","onCloseCommentLinkDialog","text","createdAt","toLocaleString","color","Thread","onSubmitComment","onSubmitCommentCallback","onCancelCreateThread","fetchContacts","usePlateEditorRef","areContactsShown","setAreContactsShown","setContacts","filteredContacts","setFilteredContacts2","haveContactsBeenClosed","setHaveContactsBeenClosed","setSelectedContactIndex","retrieveMentionStringAtCaretPosition","isMentionStringNextToCaret","indexOfLastCharacterOfMentionString","selectionStart","mentionStringStartIndex","substr","indexOf","mentionRegExp","match","exec","lastIndex","length","mentionString","trim","mentionStringEndIndex","string","startIndex","endIndex","retrieveMentionStringAfterAtCharacter","filterContacts","contacts2","mentionStringAfterAtCharacter","newFilteredContacts","filter","doesContactMatchString","setFilteredContacts","filteredContacts2","Math","min","updateFilteredContacts","newComment","floor","random","Date","hasComments","comments","clearTextArea","isResolved","upsertThread","threadNodeEntry","Array","from","findThreadNodeEntries","find","threadNodeEntry2","Transforms","setNodes","at","deleteThread","deleteThreadAtSelection","deleteComment","comment2","isFirstComment","showContacts","hideContacts","insertMention","mentionedContact","mentionInsertString","selectionIndex","setSelectionRange","onContactSelected","onKeyDown","key","code","max","onKeyUp","some","onContactsClosed","onShow","loadContacts","loadContacts2","commentInputCss","commentInputClassName","concat","createThreadsStyles","createHeaderStyles","createBodyStyles","wasClickOnTargetInsideThreads","closestThreadsParent","target","closest","Boolean","Threads","parent","position","setPosition","parentElement","newPosition","clientHeight","clientWidth","header","threadNodeEntries","threads","resolvedThreads","registerOnClick","isMounted","setTimeout","addEventListener","removeEventListener","ToggleShowThreadsButton","areThreadsShown","setAreThreadsShown","toggleShowThreads","showThreads","onCloseThreads","createThreadElementStyles","selected","resolved","determineStyle","style","ThreadElement","attributes","children","nodeProps","rootProps","getRootProps","createSideThreadStyles","SideThread","useComments","setThread","threadPosition","setThreadPosition","newThreadThreadNodeEntry","setNewThreadThreadNodeEntry","updateThreadPosition","selectionDOMNode","ReactEditor","toDOMNode","selectionDOMNodePosition","editorDOMNode","x","editorX","editorWidth","getBoundingClientRect","newThreadPosition","showThread","selectedThread","requestAnimationFrame","hideThread","handleThreadIdInURL","url","URL","window","location","href","threadIdQueryParam","searchParams","get","threadId","parseInt","collapse","edge","domNode","scrollIntoView","onEditorChange","type","getPluginType","ELEMENT_THREAD","getAbove","isThreadNodeTheNewThreadNode","selection","newThread","newThreadThreadNodeEntry2","push"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAQaA,sBAAsB,GAAGC,sBAAsB,CAC1D,CAAC;AAAEC,EAAAA,EAAF;AAAMC,EAAAA,WAAN;AAAmB,KAAGC;AAAtB,CAAD,KAAuD;AACrDF,EAAAA,EAAE,GAAGG,eAAe,CAACH,EAAD,CAApB;AACA,QAAMI,MAAM,GAAGC,mBAAmB,CAACL,EAAD,CAAlC;AAEA,sBACEM,6BAAC,aAAD;AACE,IAAA,WAAW,EAAGC,KAAD,IAAW;AACtB,UAAI,CAACH,MAAL,EAAa;AACX;AACD;;AAEDG,MAAAA,KAAK,CAACC,cAAN;AACAP,MAAAA,WAAW;AACZ;AARH,KASMC,KATN,EADF;AAaD,CAlByD;;ACRrD,SAASO,yBAAT,CAAmCC,OAAnC,EAAyD;AAC9D,MAAIC,IAAI,GAAG,CAAX;AACA,MAAIC,GAAG,GAAG,CAAV;AACA,MAAIC,cAAkC,GAAGH,OAAzC;;AACA,KAAG;AACDC,IAAAA,IAAI,IAAIE,cAAc,CAACC,UAAf,IAA6B,CAArC;AACAF,IAAAA,GAAG,IAAIC,cAAc,CAACE,SAAf,IAA4B,CAAnC;AACAF,IAAAA,cAAc,GAAGA,cAAc,CAACG,YAAhC;AACD,GAJD,QAISH,cAJT;;AAKA,SAAO;AACLF,IAAAA,IADK;AAELC,IAAAA;AAFK,GAAP;AAID;;ACAM,MAAMK,QAAN,SAAuBX,cAAK,CAACY,SAA7B,CAAsD;AAI3DC,EAAAA,WAAW,CAACjB,KAAD,EAAuB;AAChC,UAAMA,KAAN;AAEA,SAAKkB,WAAL,gBAAmBd,cAAK,CAACe,SAAN,EAAnB;AAEA,SAAKC,cAAL,GAAsB,KAAKA,cAAL,CAAoBC,IAApB,CAAyB,IAAzB,CAAtB;AACD;;AAEDC,EAAAA,iBAAiB,GAAG;AAClB,SAAKC,YAAL,GAAoB,IAAIC,OAAJ,CAAY,KAAKN,WAAL,CAAiBO,OAA7B,CAApB;AACA,SAAKF,YAAL,CAAkBG,oBAAlB,CAAuCC,iBAAiB,CAACC,IAAzD;AACA,SAAKL,YAAL,CAAkBM,eAAlB,CAAkCC,MAAM,CAACC,YAAzC;AAEA,UAAM;AAAEC,MAAAA;AAAF,QAAe,KAAKhC,KAA1B;AACA,SAAKuB,YAAL,CAAkBU,MAAlB,CAAyB,kBAAzB,EAA6C,KAAKb,cAAlD;AACA,SAAKG,YAAL,CAAkBU,MAAlB,CAAyB,uBAAzB,EAAkDD,QAAlD;AAEA,SAAKT,YAAL,CAAkBW,IAAlB,GAAyB,IAAzB;AACD;;AAEDC,EAAAA,oBAAoB,GAAG;AACrB,SAAKZ,YAAL,CAAmBa,QAAnB,CAA4B,kBAA5B,EAAgD,KAAKhB,cAArD;AACA,UAAM;AAAEY,MAAAA;AAAF,QAAe,KAAKhC,KAA1B;AACA,SAAKuB,YAAL,CAAmBa,QAAnB,CAA4B,uBAA5B,EAAqDJ,QAArD;AACA,SAAKT,YAAL,CAAmBc,OAAnB;AACD;;AAEDjB,EAAAA,cAAc,CAACf,KAAD,EAAqB;AACjC,UAAM;AAAEiC,MAAAA;AAAF,QAAe,KAAKtC,KAA1B;AACA,UAAMuC,oBAAoB,GAAGlC,KAAK,CAACmC,MAAN,CAAaC,KAA1C;AACA,UAAMC,eAAe,GAAGJ,QAAQ,CAACC,oBAAD,CAAhC;AACA,UAAM;AAAEI,MAAAA;AAAF,QAAiB,KAAK3C,KAA5B;AACA2C,IAAAA,UAAU,CAACD,eAAD,CAAV;AACD;;AAEDE,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEN,MAAAA,QAAF;AAAYO,MAAAA;AAAZ,QAA8B,KAAK7C,KAAzC;AAEA,wBACEI;AAAK,MAAA,GAAG,EAAE,KAAKc,WAAf;AAA4B,MAAA,SAAS,EAAC;AAAtC,oBACEd;AACE,MAAA,SAAS,EAAC,oCADZ;AAEE,MAAA,IAAI,EAAC,MAFP;AAGE,qBAAY,MAHd;AAIE,0BAAiB,UAJnB;AAKE,MAAA,QAAQ,EAAE,CAAC;AALb,OAOGkC,QAAQ,CAACQ,GAAT,CAAa,CAAC;AAAEC,MAAAA,IAAF;AAAQC,MAAAA,KAAR;AAAeC,MAAAA;AAAf,KAAD,EAA6BR,KAA7B,kBACZrC;AACE,MAAA,GAAG,EAAE4C,KADP;AAEE,MAAA,SAAS,EAAG,iFACVP,KAAK,KAAKI,aAAV,GAA0B,0BAA1B,GAAuD,EACxD,EAJH;AAKE,MAAA,QAAQ,EAAEJ,KAAK,KAAKI,aAAV,GAA0B,CAA1B,GAA8B,CAAC;AAL3C,oBAOEzC;AAAM,MAAA,SAAS,EAAC;AAAhB,MAPF,eAQEA;AAAM,MAAA,SAAS,EAAC;AAAhB,oBACEA;AAAK,MAAA,GAAG,EAAE6C,SAAV;AAAqB,MAAA,GAAG,EAAC,QAAzB;AAAkC,MAAA,KAAK,EAAE,EAAzC;AAA6C,MAAA,MAAM,EAAE;AAArD,MADF,CARF,eAWE7C;AAAM,MAAA,SAAS,EAAC;AAAhB,oBACEA;AAAM,MAAA,SAAS,EAAC;AAAhB,OAA+C2C,IAA/C,CADF,eAEE3C;AAAM,MAAA,SAAS,EAAC;AAAhB,OAAiD4C,KAAjD,CAFF,CAXF,CADD,CAPH,CADF,CADF;AA8BD;;AAxE0D;;ACVtD,MAAME,kBAAkB,GAAIlD,KAAD,IAChCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,QADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AAeA,MAAMC,yBAAyB,GAAIvD,KAAD,IACvCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,qBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AA4BA,MAAME,wBAAwB,GAAIxD,KAAD,IACtCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,oBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AA0BA,MAAMG,+BAA+B,GAAIzD,KAAD,IAC7CmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,2BADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AA+BA,MAAMI,2BAA2B,GAAI1D,KAAD,IACzCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,uBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AA+BA,MAAMK,yBAAyB,GAAI3D,KAAD,IACvCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,qBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AA8BA,MAAMM,qBAAqB,GAAI5D,KAAD,IACnCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,iBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AAiBA,MAAMO,wBAAwB,GAAI7D,KAAD,IACtCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,oBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF,kYADN;AAsBEQ,EAAAA,iBAAiB,EAAER,GAAF;AAtBnB,CALU,CADP;AAoCA,MAAMS,oBAAoB,GAAI/D,KAAD,IAClCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,gBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AA+BA,MAAMU,mBAAmB,GAAIhE,KAAD,IACjCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,eADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AAyBA,MAAMW,yBAAyB,GAAIjE,KAAD,IACvCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,qBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AAiDA,MAAMY,wBAAwB,GAAIlE,KAAD,IACtCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,qBADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;;;;;;;;;;;AClUP,SAAS,QAAQ,GAAG;AACpB,EAAE,cAAc,GAAG,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,UAAU,MAAM,EAAE;AACjE,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC/C,MAAM,IAAI,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;AAChC;AACA,MAAM,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;AAC9B,QAAQ,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;AAC/D,UAAU,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AACpC,SAAS;AACT,OAAO;AACP,KAAK;AACL;AACA,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG,CAAC;AACJ;AACA,EAAE,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,OAAO,EAAE,yBAAyB,GAAG,IAAI,CAAC;AAC/E,EAAE,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AACzC,CAAC;AACD;AACA,cAAc,GAAG,QAAQ,CAAC;AAC1B,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,OAAO,EAAE,yBAAyB,GAAG,IAAI;;;;;;ACpB5E,SAAS,QAAQ,GAAG;AACpB,EAAE,cAAc,GAAG,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,UAAU,MAAM,EAAE;AACjE,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC/C,MAAM,IAAI,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;AAChC;AACA,MAAM,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;AAC9B,QAAQ,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;AAC/D,UAAU,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AACpC,SAAS;AACT,OAAO;AACP,KAAK;AACL;AACA,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG,CAAC;AACJ;AACA,EAAE,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,OAAO,EAAE,yBAAyB,GAAG,IAAI,CAAC;AAC/E,EAAE,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;AACzC,CAAC;AACD;AACA,cAAc,GAAG,QAAQ,CAAC;AAC1B,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,OAAO,EAAE,yBAAyB,GAAG,IAAI;;;;;;ACpB5E,SAAS,eAAe,CAAC,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE;AAC1C,EAAE,IAAI,GAAG,IAAI,GAAG,EAAE;AAClB,IAAI,MAAM,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,EAAE;AACpC,MAAM,KAAK,EAAE,KAAK;AAClB,MAAM,UAAU,EAAE,IAAI;AACtB,MAAM,YAAY,EAAE,IAAI;AACxB,MAAM,QAAQ,EAAE,IAAI;AACpB,KAAK,CAAC,CAAC;AACP,GAAG,MAAM;AACT,IAAI,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;AACrB,GAAG;AACH;AACA,EAAE,OAAO,GAAG,CAAC;AACb,CAAC;AACD;AACA,cAAc,GAAG,eAAe,CAAC;AACjC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,OAAO,EAAE,yBAAyB,GAAG,IAAI;;;;;;AChB5E,SAAS,6BAA6B,CAAC,MAAM,EAAE,QAAQ,EAAE;AACzD,EAAE,IAAI,MAAM,IAAI,IAAI,EAAE,OAAO,EAAE,CAAC;AAChC,EAAE,IAAI,MAAM,GAAG,EAAE,CAAC;AAClB,EAAE,IAAI,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AACvC,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;AACb;AACA,EAAE,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC1C,IAAI,GAAG,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;AACxB,IAAI,IAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,SAAS;AAC7C,IAAI,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AAC9B,GAAG;AACH;AACA,EAAE,OAAO,MAAM,CAAC;AAChB,CAAC;AACD;AACA,cAAc,GAAG,6BAA6B,CAAC;AAC/C,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,OAAO,EAAE,yBAAyB,GAAG,IAAI;;;;;;ACd5E,SAAS,wBAAwB,CAAC,MAAM,EAAE,QAAQ,EAAE;AACpD,EAAE,IAAI,MAAM,IAAI,IAAI,EAAE,OAAO,EAAE,CAAC;AAChC,EAAE,IAAI,MAAM,GAAG,4BAA4B,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;AAC9D,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;AACb;AACA,EAAE,IAAI,MAAM,CAAC,qBAAqB,EAAE;AACpC,IAAI,IAAI,gBAAgB,GAAG,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC;AAChE;AACA,IAAI,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,gBAAgB,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAClD,MAAM,GAAG,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAC;AAChC,MAAM,IAAI,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,SAAS;AAC/C,MAAM,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,oBAAoB,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE,SAAS;AAC7E,MAAM,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;AAChC,KAAK;AACL,GAAG;AACH;AACA,EAAE,OAAO,MAAM,CAAC;AAChB,CAAC;AACD;AACA,cAAc,GAAG,wBAAwB,CAAC;AAC1C,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,MAAM,CAAC,OAAO,EAAE,yBAAyB,GAAG,IAAI;;;;;ACtB5E,SAAS,OAAO,CAAC,EAAE,EAAE;AACrB,EAAE,IAAI,KAAK,GAAG,EAAE,CAAC;AACjB,EAAE,OAAO,UAAU,GAAG,EAAE;AACxB,IAAI,IAAI,KAAK,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE,KAAK,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC;AACvD,IAAI,OAAO,KAAK,CAAC,GAAG,CAAC,CAAC;AACtB,GAAG,CAAC;AACJ;;ACJA,IAAI,eAAe,GAAG,25HAA25H,CAAC;AACl7H;AACA,IAAI,KAAK,GAAG,OAAO,CAAC,UAAU,IAAI,EAAE;AACpC,EAAE,OAAO,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,GAAG;AACjE;AACA,KAAK,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,KAAK,GAAG;AAC/B;AACA,KAAK,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;AAC7B,CAAC;AACD;AACA,CAAC;;ACRD,SAAS,OAAO,CAAC,MAAM,EAAE,cAAc,EAAE,EAAE,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC,qBAAqB,EAAE,EAAE,IAAI,OAAO,GAAG,MAAM,CAAC,qBAAqB,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,cAAc,EAAE,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,GAAG,EAAE,EAAE,OAAO,MAAM,CAAC,wBAAwB,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,EAAE,CAAC,OAAO,IAAI,CAAC,EAAE;AACrV;AACA,SAAS,aAAa,CAAC,MAAM,EAAE,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,IAAI,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,IAAI,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,UAAU,GAAG,EAAE,EAAE,eAAe,CAAC,MAAM,EAAE,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,EAAE,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC,yBAAyB,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,GAAG,EAAE,EAAE,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,EAAE,MAAM,CAAC,wBAAwB,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,MAAM,CAAC,EAAE;AAKthB;AACA,SAAS,WAAW,CAAC,GAAG,EAAE;AAC1B,EAAE,OAAOa,KAAS,CAAC,GAAG,CAAC,CAAC;AACxB,CAAC;AACD;AACA,SAAS,cAAc,CAAC,KAAK,EAAE;AAC/B,EAAE,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE;AACnD,IAAI,IAAI,WAAW,CAAC,CAAC,CAAC,EAAE;AAGxB,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;AACtB,KAAK;AACL;AACA,IAAI,OAAO,CAAC,CAAC;AACb,GAAG,EAAE,EAAE,CAAC,CAAC;AACT,CAAC;AACD;AACA,IAAI,kBAAkB,gBAAgB,KAAK,CAAC,UAAU,CAAC,UAAU,KAAK,EAAE,GAAG,EAAE;AAC7E,EAAK,IAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;AAChC,MAAM,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC;AAClC,MAA0B,KAAK,CAAC,iBAAiB,CAAC;AAClD,UAAM,WAAW,GAAG,KAAK,CAAC,WAAW,CAAC;AACtC,MAAM,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;AACxB,MAAM,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;AAC1B,MAAM,UAAU,GAAG,wBAAwB,CAAC,KAAK,EAAE,CAAC,UAAU,EAAE,WAAW,EAAE,mBAAmB,EAAE,aAAa,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE;AACnI;AACA,EAAE,IAAI,SAAS,GAAG,aAAa,CAAC;AAChC,IAAI,OAAO,EAAE,WAAW;AACxB,IAAI,MAAM,EAAE,KAAK,CAAC,MAAM,KAAK,SAAS,GAAG,KAAK,CAAC,MAAM,GAAG,IAAI;AAC5D,IAAI,KAAK,EAAE,KAAK,CAAC,KAAK,KAAK,SAAS,GAAG,KAAK,CAAC,KAAK,GAAG,IAAI;AACzD,IAAI,aAAa,EAAE,KAAK,IAAI,IAAI,GAAG,MAAM,GAAG,SAAS;AACrD,IAAI,SAAS,EAAE,OAAO;AACtB,IAAI,IAAI,EAAE,KAAK,IAAI,IAAI,GAAG,KAAK,GAAG,SAAS;AAC3C,GAAG,EAAE,SAAS,CAAC,CAAC;AAChB;AACA,EAAE,IAAI,QAAQ,GAAG,cAAc,CAAC,UAAU,CAAC,CAAC;AAC5C,EAAE,oBAAoB,KAAK,CAAC,aAAa,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE;AACnF,IAAI,GAAG,EAAE,GAAG;AACZ,GAAG,CAAC,EAAE,KAAK,iBAAiB,KAAK,CAAC,aAAa,CAAC,OAAO,EAAE;AACzD,IAAI,GAAG,EAAE,YAAY;AACrB,GAAG,EAAE,KAAK,CAAC,EAAE,QAAQ,CAAC,CAAC;AACvB,CAAC,CAAC,CAAC;AACI,IAAI,cAAc,gBAAgBC,OAAM,CAAC,kBAAkB,CAAC,CAAC,UAAU,CAAC;AAC/E,EAAE,WAAW,EAAE,gBAAgB;AAC/B,EAAE,WAAW,EAAE,UAAU;AACzB,CAAC,CAAC,CAAC,CAAC,sCAAsC,EAAE,mBAAmB,CAAC,EAAE,UAAU,KAAK,EAAE;AACnF,EAAE,OAAO,KAAK,CAAC,iBAAiB,CAAC;AACjC,CAAC,CAAC;;ACvDK,IAAI,KAAK,gBAAgB,KAAK,CAAC,UAAU,CAAC,UAAU,KAAK,EAAE,GAAG,EAAE;AACvE,EAAE,IAAI,KAAK,GAAG;AACd,IAAI,MAAM,EAAE,cAAc;AAC1B,IAAI,OAAO,EAAE,4BAA4B;AACzC,GAAG,CAAC;AACJ,EAAE,oBAAoB,KAAK,CAAC,aAAa,CAAC,cAAc,EAAEC,UAAQ,CAAC;AACnE,IAAI,SAAS,EAAE,KAAK;AACpB,IAAI,iBAAiB,EAAE,QAAQ;AAC/B,IAAI,WAAW,EAAE,WAAW;AAC5B,GAAG,EAAE,KAAK,EAAE;AACZ,IAAI,GAAG,EAAE,GAAG;AACZ,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,IAAI,EAAE,MAAM;AAChB,IAAI,CAAC,EAAE,eAAe;AACtB,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,CAAC,EAAE,mDAAmD;AAC1D,GAAG,CAAC,CAAC,CAAC;AACN,CAAC,CAAC,CAAC;AACH,KAAK,CAAC,WAAW,GAAG,OAAO;;AClBpB,IAAI,SAAS,gBAAgB,KAAK,CAAC,UAAU,CAAC,UAAU,KAAK,EAAE,GAAG,EAAE;AAC3E,EAAE,IAAI,KAAK,GAAG;AACd,IAAI,MAAM,EAAE,cAAc;AAC1B,IAAI,OAAO,EAAE,4BAA4B;AACzC,GAAG,CAAC;AACJ,EAAE,oBAAoB,KAAK,CAAC,aAAa,CAAC,cAAc,EAAEA,UAAQ,CAAC;AACnE,IAAI,SAAS,EAAE,KAAK;AACpB,IAAI,iBAAiB,EAAE,QAAQ;AAC/B,IAAI,WAAW,EAAE,WAAW;AAC5B,GAAG,EAAE,KAAK,EAAE;AACZ,IAAI,GAAG,EAAE,GAAG;AACZ,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,KAAK,EAAE,EAAE;AACb,IAAI,MAAM,EAAE,EAAE;AACd,IAAI,IAAI,EAAE,MAAM;AAChB,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,CAAC,EAAE,mOAAmO;AAC1O,GAAG,CAAC,CAAC,CAAC;AACN,CAAC,CAAC,CAAC;AACH,SAAS,CAAC,WAAW,GAAG,WAAW;;ACnB5B,IAAI,KAAK,gBAAgB,KAAK,CAAC,UAAU,CAAC,UAAU,KAAK,EAAE,GAAG,EAAE;AACvE,EAAE,IAAI,KAAK,GAAG;AACd,IAAI,MAAM,EAAE,cAAc;AAC1B,IAAI,OAAO,EAAE,4BAA4B;AACzC,GAAG,CAAC;AACJ,EAAE,oBAAoB,KAAK,CAAC,aAAa,CAAC,cAAc,EAAEA,UAAQ,CAAC;AACnE,IAAI,SAAS,EAAE,KAAK;AACpB,IAAI,iBAAiB,EAAE,QAAQ;AAC/B,IAAI,WAAW,EAAE,WAAW;AAC5B,GAAG,EAAE,KAAK,EAAE;AACZ,IAAI,GAAG,EAAE,GAAG;AACZ,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,IAAI,EAAE,MAAM;AAChB,IAAI,CAAC,EAAE,eAAe;AACtB,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,CAAC,EAAE,uGAAuG;AAC9G,GAAG,CAAC,CAAC,CAAC;AACN,CAAC,CAAC,CAAC;AACH,KAAK,CAAC,WAAW,GAAG,OAAO;;AClBpB,MAAMC,uBAAuB,GAAItE,KAAD,IACrCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,6BADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;;ACkBA,MAAMiB,gBAAN,SAA+BnE,cAAK,CAACY,SAArC,CAAuE;AAU5EC,EAAAA,WAAW,CAACjB,KAAD,EAAgC;AACzC,UAAMA,KAAN;AACA,SAAKwE,GAAL,gBAAWpE,cAAK,CAACe,SAAN,EAAX;AACA,SAAKsD,QAAL,gBAAgBrE,cAAK,CAACe,SAAN,EAAhB;AACA,SAAKuD,WAAL,gBAAmBtE,cAAK,CAACe,SAAN,EAAnB;AACA,SAAKwD,aAAL,gBAAqBvE,cAAK,CAACe,SAAN,EAArB;AACA,SAAKyD,iBAAL,gBAAyBxE,cAAK,CAACe,SAAN,EAAzB;AACA,SAAK0D,UAAL,GAAkB,KAAKA,UAAL,CAAgBxD,IAAhB,CAAqB,IAArB,CAAlB;AACA,UAAM;AAAEgC,MAAAA,IAAI,EAAEyB;AAAR,QAAwBR,uBAAuB,CAACtE,KAAD,CAArD;AACA,SAAK8E,WAAL,GAAmBA,WAAnB;AACD;;AAEDxD,EAAAA,iBAAiB,GAAG;AAClB,SAAKyD,MAAL,GAAc,IAAIC,SAAJ,CAAc,KAAKR,GAAL,CAAS/C,OAAvB,CAAd;AACA,QAAIwD,SAAJ,CAAc,KAAKN,aAAL,CAAmBlD,OAAjC;AACA,QAAIwD,SAAJ,CAAc,KAAKL,iBAAL,CAAuBnD,OAArC;AACA,SAAKgD,QAAL,CAAchD,OAAd,CAAuByD,MAAvB;AACA,SAAKC,QAAL,GAAgB,IAAIC,WAAJ,CAAgB,KAAKV,WAAL,CAAiBjD,OAAjC,CAAhB;AACD;;AAEe,QAAVoD,UAAU,GAAG;AACjB,UAAM;AAAEQ,MAAAA;AAAF,QAAiB,KAAKrF,KAA5B;AACA,UAAMsF,SAAS,CAACC,SAAV,CAAoBC,SAApB,CAA8BH,UAA9B,CAAN;AACA,SAAKF,QAAL,CAAejD,IAAf;AACA,SAAKuC,QAAL,CAAchD,OAAd,CAAuByD,MAAvB;AACD;;AAEDtC,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEyC,MAAAA,UAAF;AAAcI,MAAAA;AAAd,QAA0B,KAAKzF,KAArC;AAEA,wBAAO0F,QAAQ,CAACC,YAAT,eACLvF;AACE,MAAA,GAAG,EAAE,KAAKoE,GADZ;AAEE,MAAA,SAAS,EAAC;AAFZ,oBAIEpE;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA;AACE,MAAA,SAAS,EAAC,qBADZ;AAEE,MAAA,IAAI,EAAC,aAFP;AAGE,oBAAW,MAHb;AAIE,yBAAgB,2BAJlB;AAKE,0BAAiB;AALnB,oBAOEA;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA;AAAI,MAAA,SAAS,EAAC,mBAAd;AAAkC,MAAA,EAAE,EAAC;AAArC,wBADF,eAIEA;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,SAAS,EAAG,GAAE,KAAK0E,WAAL,CAAiBc,SAAU,oCAH3C;AAIE,gCAAuB,OAJzB;AAKE,MAAA,OAAO,EAAEH,OALX;AAAA,aACO,KAAKX,WAAL,CAAiBxB;AADxB,oBAOElD;AAAK,MAAA,SAAS,EAAC;AAAf,MAPF,eAQEA,6BAAC,KAAD,OARF,CAJF,CAPF,eAsBEA;AACE,MAAA,SAAS,EAAC,qBADZ;AAEE,MAAA,EAAE,EAAC;AAFL,oBAIEA;AACE,MAAA,SAAS,EAAC,kEADZ;AAEE,MAAA,KAAK,EAAE;AAAEyF,QAAAA,KAAK,EAAE;AAAT;AAFT,oBAIEzF;AAAM,MAAA,SAAS,EAAC;AAAhB,oBACEA;AAAM,MAAA,SAAS,EAAC;AAAhB,MADF,eAEEA;AAAM,MAAA,SAAS,EAAC;AAAhB,MAFF,CAJF,eAQEA;AACE,MAAA,GAAG,EAAE,KAAKqE,QADZ;AAEE,MAAA,SAAS,EAAC,uBAFZ;AAGE,MAAA,IAAI,EAAC,MAHP;AAIE,oBAAW,cAJb;AAKE,MAAA,YAAY,EAAEY,UALhB;AAME,MAAA,QAAQ;AANV,MARF,CAJF,eAsBEjF;AACE,MAAA,GAAG,EAAE,KAAKsE,WADZ;AAEE,MAAA,SAAS,EAAC,cAFZ;AAGE,MAAA,KAAK,EAAE;AAAEoB,QAAAA,MAAM,EAAE;AAAV;AAHT,oBAKE1F;AACE,MAAA,SAAS,EAAC,uBADZ;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,uBAAc;AAHhB,oBAKEA;AAAK,MAAA,SAAS,EAAC,qBAAf;AAAqC,qBAAY;AAAjD,oDALF,CALF,CAtBF,CAtBF,eA4DEA;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA;AACE,MAAA,GAAG,EAAE,KAAKuE,aADZ;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,SAAS,EAAC,+BAHZ;AAIE,gCAAuB,MAJzB;AAKE,MAAA,OAAO,EAAEc;AALX,oBAOErF;AAAK,MAAA,SAAS,EAAC;AAAf,MAPF,eAQEA;AAAM,MAAA,SAAS,EAAC;AAAhB,cARF,CADF,eAWEA;AACE,MAAA,GAAG,EAAE,KAAKwE,iBADZ;AAEE,MAAA,IAAI,EAAC,QAFP;AAGE,MAAA,SAAS,EAAC,+BAHZ;AAIE,gCAAuB,WAJzB;AAKE,MAAA,OAAO,EAAE,KAAKC;AALhB,oBAOEzE;AAAK,MAAA,SAAS,EAAC;AAAf,MAPF,eAQEA;AAAM,MAAA,SAAS,EAAC;AAAhB,mBARF,CAXF,CA5DF,CADF,CAJF,eAyFEA;AAAK,MAAA,SAAS,EAAC;AAAf,MAzFF,CADK,EA4FL2F,QAAQ,CAACC,IA5FJ,CAAP;AA8FD;;AAtI2E;;;;;;;AClBvE,IAAI,QAAQ,gBAAgB,KAAK,CAAC,UAAU,CAAC,UAAU,KAAK,EAAE,GAAG,EAAE;AAC1E,EAAE,IAAI,KAAK,GAAG;AACd,IAAI,MAAM,EAAE,cAAc;AAC1B,IAAI,OAAO,EAAE,4BAA4B;AACzC,GAAG,CAAC;AACJ,EAAE,oBAAoB,KAAK,CAAC,aAAa,CAAC,cAAc,EAAE3B,UAAQ,CAAC;AACnE,IAAI,SAAS,EAAE,KAAK;AACpB,IAAI,iBAAiB,EAAE,QAAQ;AAC/B,IAAI,WAAW,EAAE,WAAW;AAC5B,GAAG,EAAE,KAAK,EAAE;AACZ,IAAI,GAAG,EAAE,GAAG;AACZ,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,IAAI,EAAE,MAAM;AAChB,IAAI,CAAC,EAAE,eAAe;AACtB,GAAG,CAAC,eAAe,KAAK,CAAC,aAAa,CAAC,MAAM,EAAE;AAC/C,IAAI,CAAC,EAAE,mJAAmJ;AAC1J,GAAG,CAAC,CAAC,CAAC;AACN,CAAC,CAAC,CAAC;AACH,QAAQ,CAAC,WAAW,GAAG,UAAU;;AClB1B,SAAS4B,sBAAT,CAAgCjG,KAAhC,EAAoD;AACzD,SAAOmD,YAAY,CACjB;AACEC,IAAAA,gBAAgB,EAAE,kBADpB;AAEE,OAAGpD;AAFL,GADiB,EAKjB;AACEqD,IAAAA,IAAI,EAAEC,GAAF;AADN,GALiB,CAAnB;AAuBD;;ACTM,MAAM4C,UAAN,SAAyB9F,cAAK,CAACY,SAA/B,CAA0D;AAK/DC,EAAAA,WAAW,CAACjB,KAAD,EAAyB;AAClC,UAAMA,KAAN;AACA,SAAKwE,GAAL,gBAAWpE,cAAK,CAACe,SAAN,EAAX;AACA,SAAKgF,OAAL,GAAe,KAAKA,OAAL,CAAa9E,IAAb,CAAkB,IAAlB,CAAf;AACA,UAAM;AAAEgC,MAAAA,IAAI,EAAE+C;AAAR,QAAmBH,sBAAsB,CAACjG,KAAD,CAA/C;AACA,SAAKoG,MAAL,GAAcA,MAAd;AACD;;AAED9E,EAAAA,iBAAiB,GAAG;AAClB,SAAK+E,IAAL,GAAY,IAAI7E,OAAJ,CAAY,KAAKgD,GAAL,CAAS/C,OAArB,CAAZ;AACD;;AAED0E,EAAAA,OAAO,GAAG;AACR,SAAKE,IAAL,CAAWnE,IAAX,GAAkB,CAAC,KAAKmE,IAAL,CAAWnE,IAA9B;AACD;;AAEDU,EAAAA,MAAM,GAAG;AACP,UAAM;AACJ0D,MAAAA,qBADI;AAEJC,MAAAA,MAFI;AAGJC,MAAAA,QAHI;AAIJC,MAAAA;AAJI,QAKF,KAAKzG,KALT;AAOA,wBACEI;AAAK,MAAA,SAAS,EAAC;AAAf,oBACEA;AACE,MAAA,IAAI,EAAC,QADP;AAGE,MAAA,SAAS,EAAG,GAAE,KAAKgG,MAAL,CAAYR,SAAU,kBAHtC;AAIE,MAAA,OAAO,EAAE,KAAKO,OAJhB;AAAA,aAEO,KAAKC,MAAL,CAAY9C;AAFnB,oBAMElD;AAAK,MAAA,SAAS,EAAC;AAAf,MANF,eAOEA,6BAAC,QAAD,OAPF,CADF,eAUEA;AAAK,MAAA,GAAG,EAAE,KAAKoE,GAAf;AAAoB,MAAA,SAAS,EAAC;AAA9B,oBACEpE;AACE,MAAA,SAAS,EAAC,UADZ;AAEE,MAAA,IAAI,EAAC,MAFP;AAGE,qBAAY,MAHd;AAIE,0BAAiB,UAJnB;AAKE,MAAA,QAAQ,EAAE,CAAC;AALb,oBAOEA;AAAI,MAAA,SAAS,EAAC,eAAd;AAA8B,MAAA,IAAI,EAAC,UAAnC;AAA8C,MAAA,OAAO,EAAEmG;AAAvD,oBACEnG;AAAM,MAAA,SAAS,EAAC;AAAhB,MADF,eAEEA;AAAM,MAAA,SAAS,EAAC;AAAhB,cAFF,CAPF,eAWEA;AAAI,MAAA,SAAS,EAAC,eAAd;AAA8B,MAAA,IAAI,EAAC,UAAnC;AAA8C,MAAA,OAAO,EAAEoG;AAAvD,oBACEpG;AAAM,MAAA,SAAS,EAAC;AAAhB,MADF,eAEEA;AAAM,MAAA,SAAS,EAAC;AAAhB,gBAFF,CAXF,eAeEA;AACE,MAAA,SAAS,EAAC,eADZ;AAEE,MAAA,IAAI,EAAC,UAFP;AAGE,MAAA,OAAO,EAAEqG,mBAHX;AAIE,MAAA,KAAK,EAAE;AAAEC,QAAAA,OAAO,EAAEJ,qBAAqB,GAAG,OAAH,GAAa;AAA7C;AAJT,oBAMElG;AAAM,MAAA,SAAS,EAAC;AAAhB,MANF,eAOEA;AAAM,MAAA,SAAS,EAAC;AAAhB,6BAPF,CAfF,CADF,CAVF,CADF;AAwCD;;AArE8D;;;;;;;ACf1D,SAASuG,yBAAT,CAAmC3G,KAAnC,EAAuD;AAC5D,SAAOmD,YAAY,CACjB;AACEC,IAAAA,gBAAgB,EAAE,eADpB;AAEE,OAAGpD;AAFL,GADiB,EAKjB;AACEqD,IAAAA,IAAI,EAAEC,GAAF;AADN,GALiB,CAAnB;AASD;AAEM,SAASsD,+BAAT,CAAyC5G,KAAzC,EAA6D;AAClE,SAAOmD,YAAY,CACjB;AACEC,IAAAA,gBAAgB,EAAE,2BADpB;AAEE,OAAGpD;AAFL,GADiB,EAKjB;AACEqD,IAAAA,IAAI,EAAEC,GAAF;AADN,GALiB,CAAnB;AAuBD;AAEM,SAASuD,8BAAT,CAAwC7G,KAAxC,EAA4D;AACjE,SAAOmD,YAAY,CACjB;AACEC,IAAAA,gBAAgB,EAAE,2BADpB;AAEE,OAAGpD;AAFL,GADiB,EAKjB;AACEqD,IAAAA,IAAI,EAAEC,GAAF;AADN,GALiB,CAAnB;AAuBD;AAEM,SAASwD,6BAAT,CAAuC9G,KAAvC,EAA2D;AAChE,SAAOmD,YAAY,CACjB;AACEC,IAAAA,gBAAgB,EAAE,mBADpB;AAEE,OAAGpD;AAFL,GADiB,EAKjB;AACEqD,IAAAA,IAAI,EAAEC,GAAF;AADN,GALiB,CAAnB;AAaD;;ACvEM,SAASyD,oBAAT,CAA8B;AACnCC,EAAAA,WADmC;AAEnCC,EAAAA,MAAM,EAAEC,cAF2B;AAGnCC,EAAAA,QAHmC;AAInC,KAAGnH;AAJgC,CAA9B,EASU;AACf,QAAMoH,WAAW,GAAGC,MAAM,CAAsB,IAAtB,CAA1B;AAEA,QAAM;AAAEhE,IAAAA,IAAI,EAAEiE;AAAR,MAAyBzD,wBAAwB,CAAC7D,KAAD,CAAvD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEkE;AAAR,MAAqBxD,oBAAoB,CAAC/D,KAAD,CAA/C;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEmE;AAAR,MAAoBxD,mBAAmB,CAAChE,KAAD,CAA7C;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEoE;AAAR,MAA0BxD,yBAAyB,CAACjE,KAAD,CAAzD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEqE;AAAR,MAAyBxD,wBAAwB,CAAClE,KAAD,CAAvD;AAEA,QAAMiH,MAAM,GAAGU,WAAW,CACxB,SAASV,MAAT,GAAkB;AAChBC,IAAAA,cAAc,CAACE,WAAW,CAAC3F,OAAZ,CAAqBmG,KAAtB,CAAd;AACD,GAHuB,EAIxB,CAACV,cAAD,EAAiBE,WAAjB,CAJwB,CAA1B;AAOAS,EAAAA,SAAS,CACP,SAASC,KAAT,GAAiB;AACfV,IAAAA,WAAW,CAAC3F,OAAZ,CAAqBqG,KAArB;AACD,GAHM,EAIP,CAACV,WAAD,CAJO,CAAT;AAOA,sBACEhH;AAA4B,IAAA,SAAS,EAAEkH,YAAY,CAAC1B,SAApD;AAAA,WAAU0B,YAAY,CAAChE;AAAvB,kBACElD;AACE,IAAA,GAAG,EAAEgH,WADP;AAEE,IAAA,IAAI,EAAE,CAFR;AAIE,IAAA,SAAS,EAAEG,QAAQ,CAAC3B,SAJtB;AAKE,IAAA,YAAY,EAAEoB,WALhB;AAAA,YAGOO,QAAQ,CAACjE;AAHhB,IADF,eAQElD;AAAuB,IAAA,SAAS,EAAEoH,OAAO,CAAC5B,SAA1C;AAAA,YAAU4B,OAAO,CAAClE;AAAlB,kBACElD;AACE,IAAA,IAAI,EAAC,QADP;AAGE,IAAA,SAAS,EAAEqH,aAAa,CAAC7B,SAH3B;AAIE,IAAA,OAAO,EAAEqB,MAJX;AAAA,YAEOQ,aAAa,CAACnE;AAFrB,YADF,eASElD;AACE,IAAA,IAAI,EAAC,QADP;AAGE,IAAA,SAAS,EAAEsH,YAAY,CAAC9B,SAH1B;AAIE,IAAA,OAAO,EAAEuB,QAJX;AAAA,YAEOO,YAAY,CAACpE;AAFpB,cATF,CARF,CADF;AA6BD;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7CM,SAASyE,aAAT,CACL/H,KADK,EAYL;AACA,QAAM;AACJgI,IAAAA,OADI;AAEJC,IAAAA,MAFI;AAGJC,IAAAA,uBAHI;AAIJC,IAAAA,sBAJI;AAKJC,IAAAA,cALI;AAMJ9B,IAAAA,qBANI;AAOJ+B,IAAAA,eAPI;AAQJC,IAAAA,cARI;AASJ9B,IAAAA,QAAQ,EAAE+B;AATN,MAUFvI,KAVJ;AAYA,QAAM,CAACwI,QAAD,EAAWC,WAAX,IAA0BC,QAAQ,CAAC,KAAD,CAAxC;AAEA,QAAM;AAAErF,IAAAA;AAAF,MAAWsD,yBAAyB,CAAC3G,KAAD,CAA1C;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEsF;AAAR,MAA0BpF,yBAAyB,CAACvD,KAAD,CAAzD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEuF;AAAR,MAAyBpF,wBAAwB,CAACxD,KAAD,CAAvD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEwF;AAAR,MAAgCpF,+BAA+B,CAACzD,KAAD,CAArE;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEyF;AAAR,MAA4BpF,2BAA2B,CAAC1D,KAAD,CAA7D;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE0F;AAAR,MAA0BpF,yBAAyB,CAAC3D,KAAD,CAAzD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE2F;AAAR,MAAsBpF,qBAAqB,CAAC5D,KAAD,CAAjD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE4F;AAAR,MAAgCrC,+BAA+B,CAAC5G,KAAD,CAArE;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE6F;AAAR,MAA+BrC,8BAA8B,CAAC7G,KAAD,CAAnE;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE8F;AAAR,MAA8BrC,6BAA6B,CAAC9G,KAAD,CAAjE;AAEA,QAAM,CAACqF,UAAD,EAAa+D,aAAb,IAA8BV,QAAQ,CAAgB,IAAhB,CAA5C;AAEA,QAAMnC,MAAM,GAAGoB,WAAW,CAAC,SAASpB,MAAT,GAAkB;AAC3CkC,IAAAA,WAAW,CAAC,IAAD,CAAX;AACD,GAFyB,EAEvB,EAFuB,CAA1B;AAIA,QAAMjC,QAAQ,GAAGmB,WAAW,CAC1B,SAASnB,QAAT,GAAoB;AAClB+B,IAAAA,gBAAgB,CAACP,OAAD,CAAhB;AACD,GAHyB,EAI1B,CAACA,OAAD,EAAUO,gBAAV,CAJ0B,CAA5B;AAOA,QAAM9B,mBAAmB,GAAGkB,WAAW,CACrC,SAASlB,mBAAT,GAA+B;AAC7B2C,IAAAA,aAAa,CAACC,kBAAkB,CAACpB,MAAD,CAAnB,CAAb;AACD,GAHoC,EAIrC,CAACA,MAAD,CAJqC,CAAvC;AAOA,QAAMqB,wBAAwB,GAAG3B,WAAW,CAC1C,SAAS2B,wBAAT,GAAoC;AAClCF,IAAAA,aAAa,CAAC,IAAD,CAAb;AACD,GAHyC,EAI1C,EAJ0C,CAA5C;AAOA,QAAMnC,MAAM,GAAGU,WAAW,CACxB,SAASV,MAAT,CAAgBsC,IAAhB,EAA8B;AAC5BvB,IAAAA,OAAO,CAACuB,IAAR,GAAeA,IAAf,CAD4B;;AAE5Bd,IAAAA,WAAW,CAAC,KAAD,CAAX;AACD,GAJuB,EAKxB,CAACT,OAAD,CALwB,CAA1B;AAQA,QAAMb,QAAQ,GAAGQ,WAAW,CAAC,SAASR,QAAT,GAAoB;AAC/CsB,IAAAA,WAAW,CAAC,KAAD,CAAX;AACD,GAF2B,EAEzB,EAFyB,CAA5B;AAIA,sBACErI;AAAoB,IAAA,SAAS,EAAEiD,IAAI,CAACuC,SAApC;AAAA,WAAUvC,IAAI,CAACC;AAAf,kBACElD;AAA6B,IAAA,SAAS,EAAEuI,aAAa,CAAC/C,SAAtD;AAAA,YAAU+C,aAAa,CAACrF;AAAxB,kBACElD;AAA4B,IAAA,SAAS,EAAEwI,YAAY,CAAChD,SAApD;AAAA,YAAUgD,YAAY,CAACtF;AAAvB,kBACElD;AACE,IAAA,GAAG,EAAC,qEADN;AAEE,IAAA,GAAG,EAAC,SAFN;AAGE,IAAA,KAAK,EAAE,EAHT;AAIE,IAAA,MAAM,EAAE,EAJV;AAME,IAAA,SAAS,EAAEyI,mBAAmB,CAACjD,SANjC;AAAA,YAKOiD,mBAAmB,CAACvF;AAL3B,IADF,CADF,eAWElD;AAA+B,IAAA,SAAS,EAAE0I,eAAe,CAAClD,SAA1D;AAAA,YAAUkD,eAAe,CAACxF;AAA1B,kBACElD;AAA6B,IAAA,SAAS,EAAE2I,aAAa,CAACnD,SAAtD;AAAA,YAAUmD,aAAa,CAACzF;AAAxB,eADF,eAIElD;AAAyB,IAAA,SAAS,EAAE4I,SAAS,CAACpD,SAA9C;AAAA,YAAUoD,SAAS,CAAC1F;AAApB,KACG0E,OAAO,CAACwB,SAAR,CAAkBC,cAAlB,EADH,CAJF,CAXF,EAmBGvB,uBAAuB,gBACtB9H;AACE,IAAA,IAAI,EAAC,QADP;AAGE,IAAA,SAAS,EAAG,GAAE6I,mBAAmB,CAACrD,SAAU,kBAH9C;AAIE,IAAA,OAAO,EAAEyC,eAJX;AAAA,YAEOY,mBAAmB,CAAC3F;AAF3B,kBAMElD;AAAK,IAAA,SAAS,EAAC;AAAf,IANF,eAOEA,6BAAC,KAAD;AAAO,IAAA,KAAK,EAAE;AAAEsJ,MAAAA,KAAK,EAAE;AAAT;AAAd,IAPF,CADsB,GAUpB,IA7BN,EA8BGvB,sBAAsB,gBACrB/H;AACE,IAAA,IAAI,EAAC,QADP;AAGE,IAAA,SAAS,EAAG,GAAE8I,kBAAkB,CAACtD,SAAU,kBAH7C;AAIE,IAAA,OAAO,EAAE0C,cAJX;AAAA,YAEOY,kBAAkB,CAAC5F;AAF1B,kBAMElD;AAAK,IAAA,SAAS,EAAC;AAAf,IANF,eAOEA,6BAAC,SAAD,OAPF,CADqB,GAUnB,IAxCN,EAyCGgI,cAAc,gBACbhI,6BAAC,UAAD;AACE,IAAA,qBAAqB,EAAEkG,qBADzB;AAEE,IAAA,MAAM,EAAEC,MAFV;AAGE,IAAA,QAAQ,EAAEC,QAHZ;AAIE,IAAA,mBAAmB,EAAEC;AAJvB,IADa,GAOX,IAhDN,CADF,EAmDG+B,QAAQ,gBACPpI,6BAAC,oBAAD;AACE,IAAA,WAAW,EAAE4H,OAAO,CAACuB,IADvB;AAEE,IAAA,MAAM,EAAEtC,MAFV;AAGE,IAAA,QAAQ,EAAEE;AAHZ,IADO,gBAOP/G;AAEE,IAAA,SAAS,EAAE+I,iBAAiB,CAACvD,SAF/B;AAAA,aACOuD,iBAAiB,CAAC7F;AADzB,KAIG0E,OAAO,CAACuB,IAJX,CA1DJ,EAiEGlE,UAAU,gBACTjF,6BAAC,gBAAD;AACE,IAAA,UAAU,EAAEiF,UADd;AAEE,IAAA,OAAO,EAAEiE;AAFX,IADS,GAKP,IAtEN,CADF;AA0ED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjIM,SAASK,MAAT,CAAgB;AACrB1B,EAAAA,MADqB;AAErBC,EAAAA,uBAFqB;AAGrBC,EAAAA,sBAHqB;AAIrBC,EAAAA,cAJqB;AAKrBwB,EAAAA,eAAe,EAAEC,uBALI;AAMrBC,EAAAA,oBANqB;AAOrBC,EAAAA,aAPqB;AAQrB,KAAG/J;AARkB,CAAhB,EASS;AACd,QAAME,MAAM,GAAG8J,iBAAiB,EAAhC;AACA,QAAM5C,WAAW,GAAGC,MAAM,CAA6B,IAA7B,CAA1B;AACA,QAAM,CAAC4C,gBAAD,EAAmBC,mBAAnB,IAA0CxB,QAAQ,CAAU,KAAV,CAAxD;AACA,QAAM,CAACpG,QAAD,EAAW6H,WAAX,IAA0BzB,QAAQ,CAAY,EAAZ,CAAxC;AACA,QAAM,CAAC0B,gBAAD,EAAmBC,oBAAnB,IAA2C3B,QAAQ,CAAY,EAAZ,CAAzD;AACA,QAAM,CAAC4B,sBAAD,EAAyBC,yBAAzB,IAAsD7B,QAAQ,CAClE,KADkE,CAApE;AAGA,QAAM,CAACnG,oBAAD,EAAuBiI,uBAAvB,IAAkD9B,QAAQ,CAAS,CAAT,CAAhE;AAEA,QAAM+B,oCAAoC,GAAG9C,WAAW,CACtD,SAAS8C,oCAAT,GAAgD;AAC9C,UAAMlD,QAAQ,GAAGH,WAAW,CAAC3F,OAA7B;;AAEA,aAASiJ,0BAAT,CACEC,mCADF,EAEW;AACT,aACEA,mCAAmC,GAAGpD,QAAQ,CAACqD,cAA/C,IACArD,QAAQ,CAACqD,cAAT,GAA0BD,mCAA1B,KAAkE,CAFpE;AAID;;AAED,UAAM;AAAE/C,MAAAA;AAAF,QAAYL,QAAlB;AACA,UAAMsD,uBAAuB,GAAGjD,KAAK,CAClCkD,MAD6B,CACtB,CADsB,EACnBvD,QAAQ,CAACqD,cADU,EAE7BG,OAF6B,CAErB,GAFqB,CAAhC;;AAGA,QAAIF,uBAAuB,KAAK,CAAC,CAAjC,EAAoC;AAClC,YAAMG,aAAa,GAAG,kBAAtB;AACA,YAAMC,KAAK,GAAGD,aAAa,CAACE,IAAd,CAAmBtD,KAAnB,CAAd;;AACA,UAAIqD,KAAJ,EAAW;AACT,cAAMN,mCAAmC,GACvCK,aAAa,CAACG,SAAd,GAA0BF,KAAK,CAAC,CAAD,CAAL,CAASG,MAAnC,GAA4C,CAD9C;;AAEA,YAAIV,0BAA0B,CAACC,mCAAD,CAA9B,EAAqE;AACnE,gBAAMU,aAAa,GAAGJ,KAAK,CAAC,CAAD,CAAL,CAASK,IAAT,EAAtB;AACA,gBAAMC,qBAAqB,GACzBV,uBAAuB,GAAGQ,aAAa,CAACD,MAD1C;AAEA,iBAAO;AACLI,YAAAA,MAAM,EAAEH,aADH;AAELI,YAAAA,UAAU,EAAEZ,uBAFP;AAGLa,YAAAA,QAAQ,EAAEH;AAHL,WAAP;AAKD;AACF;AACF;;AACD,WAAO,IAAP;AACD,GApCqD,EAqCtD,CAACnE,WAAD,CArCsD,CAAxD;AAwCA,QAAMuE,qCAAqC,GAAGhE,WAAW,CACvD,SAASgE,qCAAT,GAAgE;AAC9D,UAAMN,aAAa,GAAGZ,oCAAoC,EAA1D;AACA,WAAOY,aAAa,GAAGA,aAAa,CAACG,MAAd,CAAqBV,MAArB,CAA4B,CAA5B,CAAH,GAAoC,IAAxD;AACD,GAJsD,EAKvD,CAACL,oCAAD,CALuD,CAAzD;AAQA,QAAMmB,cAAc,GAAGjE,WAAW,CAChC,SAASiE,cAAT,CAAwBC,SAAxB,EAA8C;AAC5C,UAAMC,6BAA6B,GAAGH,qCAAqC,EAA3E;AACA,QAAII,mBAAJ;;AACA,QAAID,6BAAJ,EAAmC;AACjCC,MAAAA,mBAAmB,GAAGF,SAAS,CAACG,MAAV,CACpBC,sBAAsB,CAAC5K,IAAvB,CAA4B,IAA5B,EAAkCyK,6BAAlC,CADoB,CAAtB;AAGD,KAJD,MAIO;AACLC,MAAAA,mBAAmB,GAAGF,SAAtB;AACD;;AACD,WAAOE,mBAAP;AACD,GAZ+B,EAahC,CAACJ,qCAAD,CAbgC,CAAlC;AAgBA,QAAMO,mBAAmB,GAAGvE,WAAW,CACrC,SAASuE,mBAAT,CAA6BC,iBAA7B,EAAgD;AAC9C9B,IAAAA,oBAAoB,CAAC8B,iBAAD,CAApB;AACA3B,IAAAA,uBAAuB,CACrB4B,IAAI,CAACC,GAAL,CAAS9J,oBAAT,EAA+B4J,iBAAiB,CAACf,MAAlB,GAA2B,CAA1D,CADqB,CAAvB;AAGD,GANoC,EAOrC,CAAC7I,oBAAD,CAPqC,CAAvC;AAUA,QAAM+J,sBAAsB,GAAG3E,WAAW,CACxC,SAAS2E,sBAAT,GAAkC;AAChCJ,IAAAA,mBAAmB,CAACN,cAAc,CAACtJ,QAAD,CAAf,CAAnB;AACD,GAHuC,EAIxC,CAACA,QAAD,EAAWsJ,cAAX,EAA2BM,mBAA3B,CAJwC,CAA1C;AAOA,QAAMtC,eAAe,GAAGjC,WAAW,CACjC,SAASiC,eAAT,GAA2B;AACzB,UAAM2C,UAAU,GAAG;AACjBzM,MAAAA,EAAE,EAAEsM,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACK,MAAL,KAAgB,IAA3B,CADa;AACqB;AACtClD,MAAAA,IAAI,EAAEnC,WAAW,CAAC3F,OAAZ,CAAqBmG,KAFV;AAGjB4B,MAAAA,SAAS,EAAE,IAAIkD,IAAJ;AAHM,KAAnB;AAKA7C,IAAAA,uBAAuB,CAAC0C,UAAD,CAAvB;AACD,GARgC,EASjC,CAAC1C,uBAAD,CATiC,CAAnC;AAYA,QAAM8C,WAAW,GAAGhF,WAAW,CAC7B,SAASgF,WAAT,GAAuB;AACrB,WAAO1E,MAAM,CAAC2E,QAAP,CAAgBxB,MAAhB,IAA0B,CAAjC;AACD,GAH4B,EAI7B,CAACnD,MAAD,CAJ6B,CAA/B;AAOA,QAAM4E,aAAa,GAAGlF,WAAW,CAC/B,SAASkF,aAAT,GAAyB;AACvBzF,IAAAA,WAAW,CAAC3F,OAAZ,CAAqBmG,KAArB,GAA6B,EAA7B;AACD,GAH8B,EAI/B,CAACR,WAAD,CAJ+B,CAAjC;AAOA,QAAMD,QAAQ,GAAGQ,WAAW,CAC1B,SAASR,QAAT,GAAoB;AAClB,QAAIwF,WAAW,EAAf,EAAmB;AACjBE,MAAAA,aAAa;AACd;;AAED/C,IAAAA,oBAAoB;AACrB,GAPyB,EAQ1B,CAAC6C,WAAD,EAAc7C,oBAAd,EAAoC+C,aAApC,CAR0B,CAA5B;AAWA,QAAMxE,eAAe,GAAGV,WAAW,CACjC,SAASU,eAAT,GAA2B;AACzBJ,IAAAA,MAAM,CAAC6E,UAAP,GAAoB,IAApB;AACAC,IAAAA,YAAY,CAAC7M,MAAD,EAAS+H,MAAT,CAAZ;AACD,GAJgC,EAKjC,CAAC/H,MAAD,EAAS+H,MAAT,CALiC,CAAnC;AAQA,QAAMK,cAAc,GAAGX,WAAW,CAChC,SAASW,cAAT,GAA0B;AACxBL,IAAAA,MAAM,CAAC6E,UAAP,GAAoB,KAApB;AACA,UAAME,eAAe,GAAGC,KAAK,CAACC,IAAN,CAAWC,qBAAqB,CAACjN,MAAD,CAAhC,EAA0CkN,IAA1C,CACrBC,gBAAD,IAA2BA,gBAAgB,CAAC,CAAD,CAAhB,CAAoBpF,MAApB,KAA+BA,MADpC,CAAxB;;AAGA,QAAI+E,eAAJ,EAAqB;AACnBM,MAAAA,UAAU,CAACC,QAAX,CACErN,MADF,EAEE;AACE+H,QAAAA,MAAM,EAAE,EAAE,GAAGA;AAAL;AADV,OAFF,EAKE;AAAEuF,QAAAA,EAAE,EAAER,eAAe,CAAC,CAAD;AAArB,OALF;AAOD;AACF,GAf+B,EAgBhC,CAAC9M,MAAD,EAAS+H,MAAT,CAhBgC,CAAlC;AAmBA,QAAMwF,YAAY,GAAG9F,WAAW,CAC9B,SAAS8F,YAAT,GAAwB;AACtBC,IAAAA,uBAAuB,CAACxN,MAAD,CAAvB;AACD,GAH6B,EAI9B,CAACA,MAAD,CAJ8B,CAAhC;AAOA,QAAMyN,aAAa,GAAGhG,WAAW,CAC/B,SAASgG,aAAT,CAAuB3F,OAAvB,EAAgC;AAC9BC,IAAAA,MAAM,CAAC2E,QAAP,GAAkB3E,MAAM,CAAC2E,QAAP,CAAgBZ,MAAhB,CACf4B,QAAD,IAAcA,QAAQ,KAAK5F,OADX,CAAlB;AAGA+E,IAAAA,YAAY,CAAC7M,MAAD,EAAS+H,MAAT,CAAZ;AACD,GAN8B,EAO/B,CAAC/H,MAAD,EAAS+H,MAAT,CAP+B,CAAjC;AAUA,QAAMzB,QAAQ,GAAGmB,WAAW,CAC1B,SAASnB,QAAT,CAAkBwB,OAAlB,EAAoC;AAClC,QAAI6F,cAAc,CAAC5F,MAAD,EAASD,OAAT,CAAlB,EAAqC;AACnCyF,MAAAA,YAAY;AACb,KAFD,MAEO;AACLE,MAAAA,aAAa,CAAC3F,OAAD,CAAb;AACD;AACF,GAPyB,EAQ1B,CAAC2F,aAAD,EAAgBF,YAAhB,EAA8BxF,MAA9B,CAR0B,CAA5B;AAWA,QAAM6F,YAAY,GAAGnG,WAAW,CAC9B,SAASmG,YAAT,GAAwB;AACtB,QAAI,CAACxD,sBAAL,EAA6B;AAC3BJ,MAAAA,mBAAmB,CAAC,IAAD,CAAnB;AACD;AACF,GAL6B,EAM9B,CAACI,sBAAD,CAN8B,CAAhC;AASA,QAAMyD,YAAY,GAAGpG,WAAW,CAAC,SAASoG,YAAT,GAAwB;AACvD7D,IAAAA,mBAAmB,CAAC,KAAD,CAAnB;AACAM,IAAAA,uBAAuB,CAAC,CAAD,CAAvB;AACD,GAH+B,EAG7B,EAH6B,CAAhC;AAKA,QAAMwD,aAAa,GAAGrG,WAAW,CAC/B,SAASqG,aAAT,CAAuBC,gBAAvB,EAAyC;AACvC,UAAM5C,aAAa,GAAGZ,oCAAoC,EAA1D;;AACA,QAAIY,aAAJ,EAAmB;AACjB,YAAM9D,QAAQ,GAAGH,WAAW,CAAC3F,OAA7B;AACA,YAAM;AAAEmG,QAAAA;AAAF,UAAYL,QAAlB;AACA,YAAM2G,mBAAmB,GAAI,IAAGD,gBAAgB,CAACjL,KAAM,GAAvD;AACAuE,MAAAA,QAAQ,CAACK,KAAT,GAAkB,GAAEA,KAAK,CAACkD,MAAN,CAClB,CADkB,EAElBO,aAAa,CAACI,UAFI,CAGlB,GAAEyC,mBAAoB,GAAEtG,KAAK,CAACkD,MAAN,CAAaO,aAAa,CAACK,QAAd,GAAyB,CAAtC,CAAyC,EAHnE;AAIA,YAAMyC,cAAc,GAClB9C,aAAa,CAACI,UAAd,GAA2ByC,mBAAmB,CAAC9C,MADjD;AAEA7D,MAAAA,QAAQ,CAACO,KAAT;AACAP,MAAAA,QAAQ,CAAC6G,iBAAT,CAA2BD,cAA3B,EAA2CA,cAA3C;AACD;AACF,GAhB8B,EAiB/B,CAAC1D,oCAAD,CAjB+B,CAAjC;AAoBA,QAAM4D,iBAAiB,GAAG1G,WAAW,CACnC,SAAS0G,iBAAT,CAA2B3L,eAA3B,EAAqD;AACnDqL,IAAAA,YAAY;AACZC,IAAAA,aAAa,CAACtL,eAAD,CAAb;AACD,GAJkC,EAKnC,CAACsL,aAAD,EAAgBD,YAAhB,CALmC,CAArC;AAQA,QAAMO,SAAS,GAAG3G,WAAW,CAC3B,SAAS2G,SAAT,CAAmBjO,KAAnB,EAA8D;AAC5D,QAAIA,KAAK,CAACkO,GAAN,KAAc,GAAd,IAAqB,CAACtE,gBAA1B,EAA4C;AAC1C6D,MAAAA,YAAY;AACb;;AAED,QAAIzN,KAAK,CAACmO,IAAN,KAAe,SAAnB,EAA8B;AAC5BnO,MAAAA,KAAK,CAACC,cAAN;AACAkK,MAAAA,uBAAuB,CAAC4B,IAAI,CAACqC,GAAL,CAAS,CAAT,EAAYlM,oBAAoB,GAAG,CAAnC,CAAD,CAAvB;AACD,KAHD,MAGO,IAAIlC,KAAK,CAACmO,IAAN,KAAe,WAAnB,EAAgC;AACrChE,MAAAA,uBAAuB,CACrB4B,IAAI,CAACC,GAAL,CAAS9J,oBAAoB,GAAG,CAAhC,EAAmC6H,gBAAgB,CAACgB,MAAjB,GAA0B,CAA7D,CADqB,CAAvB;AAGD,KAJM,MAIA,IAAI/K,KAAK,CAACmO,IAAN,KAAe,OAAnB,EAA4B;AACjC,YAAM9L,eAAe,GAAG0H,gBAAgB,CAAC7H,oBAAD,CAAxC;AACA8L,MAAAA,iBAAiB,CAAC3L,eAAD,CAAjB;AACArC,MAAAA,KAAK,CAACC,cAAN;AACD;AACF,GAlB0B,EAmB3B,CACE2J,gBADF,EAEE6D,YAFF,EAGEvL,oBAHF,EAIE6H,gBAJF,EAKEiE,iBALF,CAnB2B,CAA7B;AA4BA,QAAMK,OAAO,GAAG/G,WAAW,CACzB,SAAS+G,OAAT,GAAmB;AACjBnE,IAAAA,yBAAyB,CAAC,KAAD,CAAzB;AAEA+B,IAAAA,sBAAsB;AAEtB,UAAMR,6BAA6B,GAAGH,qCAAqC,EAA3E;;AACA,QACEG,6BAA6B,KAAK,IAAlC,KACCA,6BAA6B,KAAK,EAAlC,IACCxJ,QAAQ,CAACqM,IAAT,CACE1C,sBAAsB,CAAC5K,IAAvB,CAA4B,IAA5B,EAAkCyK,6BAAlC,CADF,CAFF,CADF,EAME;AACA,UAAI,CAAC7B,gBAAL,EAAuB;AACrB6D,QAAAA,YAAY;AACb;AACF,KAVD,MAUO;AACLC,MAAAA,YAAY;AACb;AACF,GApBwB,EAqBzB,CACEzB,sBADF,EAEEX,qCAFF,EAGErJ,QAHF,EAIE2H,gBAJF,EAKE6D,YALF,EAMEC,YANF,CArByB,CAA3B;AA+BA,QAAMa,gBAAgB,GAAGjH,WAAW,CAAC,SAASiH,gBAAT,GAA4B;AAC/DrE,IAAAA,yBAAyB,CAAC,IAAD,CAAzB;AACD,GAFmC,EAEjC,EAFiC,CAApC;AAIA1C,EAAAA,SAAS,CACP,SAASgH,MAAT,GAAkB;AAChB,UAAMtH,QAAQ,GAAGH,WAAW,CAAC3F,OAA7B;AACA8F,IAAAA,QAAQ,CAACK,KAAT,GAAiB,EAAjB;;AACA,QAAIK,MAAM,CAAC2E,QAAP,CAAgBxB,MAAhB,KAA2B,CAA/B,EAAkC;AAChC7D,MAAAA,QAAQ,CAACO,KAAT;AACD;AACF,GAPM,EAQP,CAACV,WAAD,EAAca,MAAd,CARO,CAAT;AAWAJ,EAAAA,SAAS,CACP,SAASiH,YAAT,GAAwB;AACtB,mBAAeC,aAAf,GAA+B;AAC7B,YAAMlD,SAAS,GAAG,MAAM9B,aAAa,EAArC;AACAI,MAAAA,WAAW,CAAC0B,SAAD,CAAX;AACAK,MAAAA,mBAAmB,CAACN,cAAc,CAACC,SAAD,CAAf,CAAnB;AACD;;AAEDkD,IAAAA,aAAa;AACd,GATM,EAUP,CAAChF,aAAD,EAAgB6B,cAAhB,EAAgCM,mBAAhC,CAVO,CAAT;AAaA,QAAM;AAAE7I,IAAAA;AAAF,MAAWH,kBAAkB,CAAClD,KAAD,CAAnC;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEsF;AAAR,MAA0BpF,yBAAyB,CAACvD,KAAD,CAAzD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEuF;AAAR,MAAyBpF,wBAAwB,CAACxD,KAAD,CAAvD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEwF;AAAR,MAAgCpF,+BAA+B,CAACzD,KAAD,CAArE;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEyF;AAAR,MAA4BpF,2BAA2B,CAAC1D,KAAD,CAA7D;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE0F;AAAR,MAA0BpF,yBAAyB,CAAC3D,KAAD,CAAzD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEiE,YAAR;AAAsBxD,IAAAA;AAAtB,MAA4CD,wBAAwB,CACxE7D,KADwE,CAA1E;AAGA,QAAM;AAAEqD,IAAAA,IAAI,EAAEkE;AAAR,MAAqBxD,oBAAoB,CAAC/D,KAAD,CAA/C;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEmE;AAAR,MAAoBxD,mBAAmB,CAAChE,KAAD,CAA7C;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEoE;AAAR,MAA0BxD,yBAAyB,CAACjE,KAAD,CAAzD;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAEqE;AAAR,MAAyBxD,wBAAwB,CAAClE,KAAD,CAAvD;AAEA,MAAIgP,eAAe,GAAG,CAAC,GAAG1H,YAAY,CAAChE,GAAjB,CAAtB;AACA,MAAI2L,qBAAqB,GAAG3H,YAAY,CAAC1B,SAAzC;;AACA,MAAI+G,WAAW,EAAf,EAAmB;AACjBqC,IAAAA,eAAe,GAAGA,eAAe,CAACE,MAAhB,CAAuBpL,iBAAiB,CAAER,GAA1C,CAAlB;AACA2L,IAAAA,qBAAqB,IAAK,IAAGnL,iBAAiB,CAAE8B,SAAU,EAA1D;AACD;;AAED,sBACExF;AAAoB,IAAA,SAAS,EAAEiD,IAAI,CAACuC,SAApC;AAAA,WAAUvC,IAAI,CAACC;AAAf,KACG2E,MAAM,CAAC2E,QAAP,CAAgB9J,GAAhB,CAAoB,CAACkF,OAAD,EAAmBvF,KAAnB,kBACnBrC,6BAAC,aAAD;AACE,IAAA,GAAG,EAAE4H,OAAO,CAAClI,EADf;AAEE,IAAA,OAAO,EAAEkI,OAFX;AAGE,IAAA,MAAM,EAAEC,MAHV;AAIE,IAAA,uBAAuB,EAAEC,uBAAuB,IAAIzF,KAAK,KAAK,CAJhE;AAKE,IAAA,sBAAsB,EAAE0F,sBAL1B;AAME,IAAA,cAAc,EAAEC,cANlB;AAOE,IAAA,qBAAqB,EAAE3F,KAAK,KAAK,CAPnC;AAQE,IAAA,eAAe,EAAE4F,eARnB;AASE,IAAA,cAAc,EAAEC,cATlB;AAUE,IAAA,QAAQ,EAAE9B;AAVZ,IADD,CADH,eAgBEpG,0CACG,CAACuM,WAAD,iBACCvM;AAA6B,IAAA,SAAS,EAAEuI,aAAa,CAAC/C,SAAtD;AAAA,YAAU+C,aAAa,CAACrF;AAAxB,kBACElD;AAA4B,IAAA,SAAS,EAAEwI,YAAY,CAAChD,SAApD;AAAA,YAAUgD,YAAY,CAACtF;AAAvB,kBACElD;AACE,IAAA,GAAG,EAAC,qEADN;AAEE,IAAA,GAAG,EAAC,SAFN;AAGE,IAAA,KAAK,EAAE,EAHT;AAIE,IAAA,MAAM,EAAE,EAJV;AAME,IAAA,SAAS,EAAEyI,mBAAmB,CAACjD,SANjC;AAAA,YAKOiD,mBAAmB,CAACvF;AAL3B,IADF,CADF,eAWElD;AAEE,IAAA,SAAS,EAAE0I,eAAe,CAAClD,SAF7B;AAAA,YACOkD,eAAe,CAACxF;AADvB,kBAIElD;AAA6B,IAAA,SAAS,EAAE2I,aAAa,CAACnD,SAAtD;AAAA,YAAUmD,aAAa,CAACzF;AAAxB,eAJF,CAXF,CAFJ,eAuBElD;AAA2B,IAAA,SAAS,EAAE6O,qBAAtC;AAAA,YAAUD;AAAV,kBACE5O;AAAK,IAAA,SAAS,EAAC;AAAf,kBACEA;AACE,IAAA,GAAG,EAAEgH,WADP;AAEE,IAAA,IAAI,EAAE,CAFR;AAIE,IAAA,SAAS,EAAEG,QAAQ,CAAC3B,SAJtB;AAKE,IAAA,SAAS,EAAE0I,SALb;AAME,IAAA,OAAO,EAAEI,OANX;AAOE,IAAA,WAAW,EAAG,GACZ/B,WAAW,KAAK,OAAL,GAAe,SAC3B,uBATH;AAAA,YAGOpF,QAAQ,CAACjE;AAHhB,IADF,EAYG2G,gBAAgB,iBACf7J,6BAAC,QAAD;AACE,IAAA,QAAQ,EAAEgK,gBADZ;AAEE,IAAA,UAAU,EAAEiE,iBAFd;AAGE,IAAA,QAAQ,EAAEO,gBAHZ;AAIE,IAAA,aAAa,EAAErM;AAJjB,IAbJ,CADF,eAsBEnC;AAAuB,IAAA,SAAS,EAAEoH,OAAO,CAAC5B,SAA1C;AAAA,YAAU4B,OAAO,CAAClE;AAAlB,kBACElD;AACE,IAAA,IAAI,EAAC,QADP;AAGE,IAAA,SAAS,EAAEqH,aAAa,CAAC7B,SAH3B;AAIE,IAAA,OAAO,EAAEgE,eAJX;AAAA,aAEOnC,aAAa,CAACnE;AAFrB,KAMG2E,MAAM,CAAC2E,QAAP,CAAgBxB,MAAhB,KAA2B,CAA3B,GAA+B,SAA/B,GAA2C,OAN9C,CADF,eASEhL;AACE,IAAA,IAAI,EAAC,QADP;AAGE,IAAA,SAAS,EAAEsH,YAAY,CAAC9B,SAH1B;AAIE,IAAA,OAAO,EAAEuB,QAJX;AAAA,aAEOO,YAAY,CAACpE;AAFpB,cATF,CAtBF,CAvBF,CAhBF,CADF;AAoFD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxdM,MAAM6L,mBAAmB,GAAInP,KAAD,IACjCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,SADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AAoBA,MAAM8L,kBAAkB,GAAIpP,KAAD,IAChCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,eADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;AAuBA,MAAM+L,gBAAgB,GAAIrP,KAAD,IAC9BmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,aADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU,CADP;;AC1BP,SAASgM,6BAAT,CAAuCjP,KAAvC,EAAmE;AACjE,QAAMkP,oBAAoB,GACxBlP,KAAK,CAACmP,MAAN,IACCnP,KAAK,CAACmP,MAAP,CAAsBC,OADtB,IAECpP,KAAK,CAACmP,MAAP,CAAsBC,OAAtB,CAA8B,UAA9B,CAHF;AAIA,SAAOC,OAAO,CAACH,oBAAD,CAAd;AACD;;AAEM,SAASI,OAAT,CACL3P,KADK,EAML;AACA,QAAME,MAAM,GAAG8J,iBAAiB,EAAhC;AACA,QAAM;AAAE4F,IAAAA,MAAF;AAAUnK,IAAAA,OAAV;AAAmBsE,IAAAA;AAAnB,MAAqC/J,KAA3C;AACA,QAAMwE,GAAG,GAAG6C,MAAM,CAAiB,IAAjB,CAAlB;AACA,QAAM,CAACwI,QAAD,EAAWC,WAAX,IAA0BpH,QAAQ,CAG9B,IAH8B,CAAxC;AAKAb,EAAAA,SAAS,CACP,YAAY;AACV,UAAMkI,aAAa,GAAGH,MAAM,CAACnO,OAA7B;AACA,UAAMuO,WAAW,GAAGzP,yBAAyB,CAACwP,aAAD,CAA7C;AACAC,IAAAA,WAAW,CAACtP,GAAZ,IAAmBqP,aAAa,CAACE,YAAjC;AACAD,IAAAA,WAAW,CAACvP,IAAZ,GACEuP,WAAW,CAACvP,IAAZ,GACA,MAAM+D,GAAG,CAAC/C,OAAJ,CAAayO,WADnB,GAEA,MAAMH,aAAa,CAACG,WAHtB;AAIAJ,IAAAA,WAAW,CAACE,WAAD,CAAX;AACD,GAVM,EAWP,CAACJ,MAAD,CAXO,CAAT;AAcA,QAAM;AAAEvM,IAAAA;AAAF,MAAW8L,mBAAmB,CAACnP,KAAD,CAApC;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE8M;AAAR,MAAmBf,kBAAkB,CAACpP,KAAD,CAA3C;AACA,QAAM;AAAEqD,IAAAA,IAAI,EAAE2C;AAAR,MAAiBqJ,gBAAgB,CAACrP,KAAD,CAAvC;AAEA,QAAMoQ,iBAAiB,GAAGnD,KAAK,CAACC,IAAN,CAAWC,qBAAqB,CAACjN,MAAD,CAAhC,CAA1B;AACA,QAAMmQ,OAAO,GAAGD,iBAAiB,CAACtN,GAAlB,CACbkK,eAAD,IAAqBA,eAAe,CAAC,CAAD,CAAf,CAAmB/E,MAD1B,CAAhB;AAGA,QAAMqI,eAAe,GAAGD,OAAO,CAACrE,MAAR,CAAgB/D,MAAD,IAAYA,MAAM,CAAC6E,UAAlC,CAAxB;AAEA,QAAM3G,OAAO,GAAGwB,WAAW,CACzB,SAASxB,OAAT,CAAiB9F,KAAjB,EAAoC;AAClC,QAAI,CAACiP,6BAA6B,CAACjP,KAAD,CAAlC,EAA2C;AACzCoF,MAAAA,OAAO;AACR;AACF,GALwB,EAMzB,CAACA,OAAD,CANyB,CAA3B;AASAoC,EAAAA,SAAS,CACP,SAAS0I,eAAT,GAA2B;AACzB,QAAIC,SAAS,GAAG,IAAhB;AAEAC,IAAAA,UAAU,CAAC,MAAM;AACf,UAAID,SAAJ,EAAe;AACbzK,QAAAA,QAAQ,CAACC,IAAT,CAAc0K,gBAAd,CAA+B,OAA/B,EAAwCvK,OAAxC;AACD;AACF,KAJS,EAIP,GAJO,CAAV;AAMA,WAAO,MAAM;AACXJ,MAAAA,QAAQ,CAACC,IAAT,CAAc2K,mBAAd,CAAkC,OAAlC,EAA2CxK,OAA3C;AACAqK,MAAAA,SAAS,GAAG,KAAZ;AACD,KAHD;AAID,GAdM,EAeP,CAACrK,OAAD,CAfO,CAAT;AAkBA,sBAAOT,QAAQ,CAACC,YAAT,eACLvF;AACE,IAAA,GAAG,EAAEoE,GADP;AAGE,IAAA,SAAS,EAAG,GAAEnB,IAAI,CAACuC,SAAU,UAH/B;AAIE,IAAA,KAAK,EAAE,EAAE,GAAGiK;AAAL,KAJT;AAAA,WAEOxM,IAAI,CAACC;AAFZ,kBAMElD;AAAsB,IAAA,SAAS,EAAE+P,MAAM,CAACvK,SAAxC;AAAA,YAAUuK,MAAM,CAAC7M;AAAjB,kBACElD,4DADF,CANF,eASEA;AAAoB,IAAA,SAAS,EAAE4F,IAAI,CAACJ,SAApC;AAAA,YAAUI,IAAI,CAAC1C;AAAf,KACGgN,eAAe,CAACxN,GAAhB,CAAqBmF,MAAD,IAAY;AAC/B,wBACE7H,6BAAC,MAAD;AACE,MAAA,GAAG,EAAE6H,MAAM,CAACnI,EADd;AAEE,MAAA,MAAM,EAAEmI,MAFV;AAGE,MAAA,eAAe,EAAE,MAAM,EAHzB;AAIE,MAAA,oBAAoB,EAAE,MAAM,EAJ9B;AAKE,MAAA,uBAAuB,EAAE,KAL3B;AAME,MAAA,sBAAsB,MANxB;AAOE,MAAA,cAAc,EAAE,KAPlB;AAQE,MAAA,aAAa,EAAE8B;AARjB,MADF;AAYD,GAbA,CADH,CATF,CADK,EA2BLhE,QAAQ,CAACC,IA3BJ,CAAP;AA6BD;;;;;;;;;;;;;;;;;MClHY4K,uBAAuB,GAAG/Q,sBAAsB,CAC3D,CAAC;AAAEC,EAAAA,EAAF;AAAMC,EAAAA,WAAN;AAAmBgK,EAAAA,aAAnB;AAAkC,KAAG/J;AAArC,CAAD,KAAsE;AACpEF,EAAAA,EAAE,GAAGG,eAAe,CAACH,EAAD,CAApB;AACA,QAAMI,MAAM,GAAGC,mBAAmB,CAACL,EAAD,CAAlC;AAEA,QAAM0E,GAAG,GAAG6C,MAAM,CAAiB,IAAjB,CAAlB;AAEA,QAAM,CAACwJ,eAAD,EAAkBC,kBAAlB,IAAwCpI,QAAQ,CAAC,KAAD,CAAtD;AAEA,QAAMqI,iBAAiB,GAAGpJ,WAAW,CACnC,SAASqJ,WAAT,GAAuB;AACrBF,IAAAA,kBAAkB,CAAC,CAACD,eAAF,CAAlB;AACD,GAHkC,EAInC,CAACA,eAAD,CAJmC,CAArC;AAOA,QAAMI,cAAc,GAAGtJ,WAAW,CAAC,SAASsJ,cAAT,GAA0B;AAC3DH,IAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACD,GAFiC,EAE/B,EAF+B,CAAlC;AAIA,sBACE1Q;AAAK,IAAA,GAAG,EAAEoE;AAAV,kBACEpE,6BAAC,aAAD;AACE,IAAA,MAAM,EAAEyQ,eADV;AAEE,IAAA,WAAW,EAAGxQ,KAAD,IAAW;AACtB,UAAI,CAACH,MAAL,EAAa;AACX;AACD;;AAEDG,MAAAA,KAAK,CAACC,cAAN;AACAyQ,MAAAA,iBAAiB;AAClB;AATH,KAUM/Q,KAVN,EADF,EAaG6Q,eAAe,gBACdzQ,6BAAC,OAAD;AACE,IAAA,MAAM,EAAEoE,GADV;AAEE,IAAA,OAAO,EAAEyM,cAFX;AAGE,IAAA,aAAa,EAAElH;AAHjB,IADc,GAMZ,IAnBN,CADF;AAuBD,CA3C0D;;MCFhDmH,yBAAyB,GAAIlR,KAAD,IACvCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,eADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF,+BADN;AAIE6N,EAAAA,QAAQ,EAAE7N,GAAF,+BAJV;AAOE8N,EAAAA,QAAQ,EAAE9N,GAAF;AAPV,CALU;;ACAd,SAAS+N,cAAT,CACE7Q,OADF,EAEEyH,MAFF,EAGEjI,KAHF,EAIO;AACL,MAAIsR,KAAK,GAAG,IAAZ;AACA,QAAM;AAAEjO,IAAAA,IAAF;AAAQ8N,IAAAA,QAAR;AAAkBC,IAAAA;AAAlB,MAA+BF,yBAAyB,CAAClR,KAAD,CAA9D;;AACA,MAAIiI,MAAM,CAAC6E,UAAX,EAAuB;AACrBwE,IAAAA,KAAK,GAAGF,QAAR;AACD,GAFD,MAEO,IAAI5Q,OAAO,CAAC2Q,QAAZ,EAAsB;AAC3BG,IAAAA,KAAK,GAAGH,QAAR;AACD,GAFM,MAEA;AACLG,IAAAA,KAAK,GAAGjO,IAAR;AACD;;AACD,SAAOiO,KAAP;AACD;;MAEYC,aAAa,GAAIvR,KAAD,IAA+C;AAC1E,QAAM;AAAEwR,IAAAA,UAAF;AAAcC,IAAAA,QAAd;AAAwBC,IAAAA,SAAxB;AAAmClR,IAAAA;AAAnC,MAA+CR,KAArD;AACA,QAAM;AAAEiI,IAAAA;AAAF,MAAazH,OAAnB;AAEA,QAAMmR,SAAS,GAAGC,YAAY,CAAC5R,KAAD,CAA9B;AACA,QAAMsR,KAAK,GAAGD,cAAc,CAAC7Q,OAAD,EAAUyH,MAAV,EAAkBjI,KAAlB,CAA5B;AAEA,sBACEI,yDACMoR,UADN;AAGE,IAAA,SAAS,EAAEF,KAAK,CAAC1L;AAHnB,KAIM+L,SAJN,EAKMD,SALN;AAAA,WAEOJ,KAAK,CAAChO;AAFb,MAOGmO,QAPH,CADF;AAWD;;;;;;;MCxCYI,sBAAsB,GAAI7R,KAAD,IACpCmD,YAAY,CACV;AACEC,EAAAA,gBAAgB,EAAE,YADpB;AAEE,KAAGpD;AAFL,CADU,EAKV;AACEqD,EAAAA,IAAI,EAAEC,GAAF;AADN,CALU;;ACWP,SAASwO,UAAT,CAAoB;AAAEjC,EAAAA,QAAF;AAAY,KAAG7P;AAAf,CAApB,EAA6D;AAClE,QAAM;AAAEqD,IAAAA;AAAF,MAAWwO,sBAAsB,CAAC7R,KAAD,CAAvC;AAEA,sBACEI;AAEE,IAAA,SAAS,EAAEiD,IAAI,CAACuC,SAFlB;AAGE,IAAA,KAAK,EAAE;AACLnF,MAAAA,IAAI,EAAEoP,QAAQ,CAACpP,IADV;AAELC,MAAAA,GAAG,EAAEmP,QAAQ,CAACnP;AAFT,KAHT;AAAA,WACO2C,IAAI,CAACC;AADZ,kBAQElD,6BAAC,MAAD,iBACMJ,KADN;AAEE,IAAA,uBAAuB,MAFzB;AAGE,IAAA,sBAAsB,EAAE,KAH1B;AAIE,IAAA,cAAc;AAJhB,KARF,CADF;AAiBD;;;;;;;ACNM,SAAS+R,WAAT,GAA4B;AACjC,QAAM7R,MAAM,GAAGC,mBAAmB,EAAlC;AACA,QAAM,CAAC8H,MAAD,EAAS+J,SAAT,IAAsBtJ,QAAQ,CAAgB,IAAhB,CAApC;AACA,QAAM,CAACuJ,cAAD,EAAiBC,iBAAjB,IAAsCxJ,QAAQ,CAAC;AAAEjI,IAAAA,IAAI,EAAE,CAAR;AAAWC,IAAAA,GAAG,EAAE;AAAhB,GAAD,CAApD;AACA,QAAM,CACJyR,wBADI,EAEJC,2BAFI,IAGF1J,QAAQ,CAAmB,IAAnB,CAHZ;AAKA,QAAM2J,oBAAoB,GAAG1K,WAAW,CACtC,SAAS0K,oBAAT,CAA8BrF,eAA9B,EAA+C;AAC7C,UAAMsF,gBAAgB,GAAGC,WAAW,CAACC,SAAZ,CACvBtS,MADuB,EAEvB8M,eAAe,CAAC,CAAD,CAFQ,CAAzB;AAIA,UAAMyF,wBAAwB,GAAGlS,yBAAyB,CACxD+R,gBADwD,CAA1D;AAIA,UAAMI,aAAa,GAAGH,WAAW,CAACC,SAAZ,CAAsBtS,MAAtB,EAA8BA,MAA9B,CAAtB;AACA,UAAM;AACJyS,MAAAA,CAAC,EAAEC,OADC;AAEJ/M,MAAAA,KAAK,EAAEgN;AAFH,QAGFH,aAAa,CAACI,qBAAd,EAHJ;AAKA,UAAMC,iBAAiB,GAAG;AACxBtS,MAAAA,IAAI,EAAEmS,OAAO,GAAGC,WAAV,GAAwB,EADN;AAExBnS,MAAAA,GAAG,EAAE+R,wBAAwB,CAAC/R;AAFN,KAA1B;AAIAwR,IAAAA,iBAAiB,CAACa,iBAAD,CAAjB;AACD,GArBqC,EAsBtC,CAAC7S,MAAD,CAtBsC,CAAxC;AAyBA,QAAM8S,UAAU,GAAGrL,WAAW,CAC5B,SAASqL,UAAT,CAAoBhG,eAApB,EAA0C;AACxC,UAAM;AAAE/E,MAAAA,MAAM,EAAEgL;AAAV,QAA6BjG,eAAe,CAAC,CAAD,CAAlD;AACAkG,IAAAA,qBAAqB,CAAC,MAAM;AAC1Bb,MAAAA,oBAAoB,CAACrF,eAAD,CAApB;AACAgF,MAAAA,SAAS,CAACiB,cAAD,CAAT;AACD,KAHoB,CAArB;AAID,GAP2B,EAQ5B,CAACZ,oBAAD,CAR4B,CAA9B;AAWA,QAAMc,UAAU,GAAGxL,WAAW,CAAC,SAASwL,UAAT,GAAsB;AACnDnB,IAAAA,SAAS,CAAC,IAAD,CAAT;AACD,GAF6B,EAE3B,EAF2B,CAA9B;AAIA,QAAMlI,oBAAoB,GAAGnC,WAAW,CACtC,SAASmC,oBAAT,GAAgC;AAC9B,QAAIqI,wBAAJ,EAA8B;AAC5B1E,MAAAA,YAAY,CAACvN,MAAD,EAASiS,wBAAwB,CAAC,CAAD,CAAjC,CAAZ;AACAC,MAAAA,2BAA2B,CAAC,IAAD,CAA3B;AACD;AACF,GANqC,EAOtC,CAAClS,MAAD,EAASiS,wBAAT,CAPsC,CAAxC;AAUAtK,EAAAA,SAAS,CACP,SAASuL,mBAAT,GAA+B;AAC7B,UAAMC,GAAG,GAAG,IAAIC,GAAJ,CAAQC,MAAM,CAACC,QAAP,CAAgBC,IAAxB,CAAZ;AACA,UAAMC,kBAAkB,GAAGL,GAAG,CAACM,YAAJ,CAAiBC,GAAjB,CAAqB,QAArB,CAA3B;;AACA,QAAIF,kBAAJ,EAAwB;AACtB,YAAMG,QAAQ,GAAGC,QAAQ,CAACJ,kBAAD,EAAqB,EAArB,CAAzB;AACA,YAAMtD,iBAAiB,GAAGnD,KAAK,CAACC,IAAN,CAAWC,qBAAqB,CAACjN,MAAD,CAAhC,CAA1B;AACA,YAAM8M,eAAe,GAAGoD,iBAAiB,CAAChD,IAAlB,CACrBC,gBAAD,IAA2BA,gBAAgB,CAAC,CAAD,CAAhB,CAAoBpF,MAApB,CAA2BnI,EAA3B,KAAkC+T,QADvC,CAAxB;;AAGA,UAAI7G,eAAJ,EAAqB;AACnBuF,QAAAA,WAAW,CAACzK,KAAZ,CAAkB5H,MAAlB;AACAoN,QAAAA,UAAU,CAACpI,MAAX,CAAkBhF,MAAlB,EAA0B8M,eAAe,CAAC,CAAD,CAAzC;AACAM,QAAAA,UAAU,CAACyG,QAAX,CAAoB7T,MAApB,EAA4B;AAAE8T,UAAAA,IAAI,EAAE;AAAR,SAA5B;AACAhB,QAAAA,UAAU,CAAChG,eAAD,CAAV;AAEA,cAAMiH,OAAO,GAAG1B,WAAW,CAACC,SAAZ,CAAsBtS,MAAtB,EAA8B8M,eAAe,CAAC,CAAD,CAA7C,CAAhB;AACAiH,QAAAA,OAAO,CAACC,cAAR;AAEAX,QAAAA,MAAM,CAAC7C,gBAAP,CAAwB,MAAxB,EAAgC,MAAM;AACpC2B,UAAAA,oBAAoB,CAACrF,eAAD,CAApB;AACD,SAFD;AAGD;AACF;AACF,GAxBM,EAyBP,CAAC9M,MAAD,EAAS8S,UAAT,EAAqBX,oBAArB,CAzBO,CAAT;AA4BAxK,EAAAA,SAAS,CACP,SAASsM,cAAT,GAA0B;AACxB,UAAMC,IAAI,GAAGC,aAAa,CAACnU,MAAD,EAASoU,cAAT,CAA1B,CADwB;;AAGxB,UAAMtH,eAAe,GAAGuH,QAAQ,CAACrU,MAAD,EAAS;AACvC+K,MAAAA,KAAK,EAAE;AAAEmJ,QAAAA;AAAF;AADgC,KAAT,CAAhC;AAGA,UAAMI,4BAA4B,GAChCxH,eAAe,IACfmF,wBADA,IAEAnF,eAAe,CAAC,CAAD,CAAf,CAAmBlN,EAAnB,KAA2BqS,wBAAwB,CAAC,CAAD,CAAzB,CAAqCrS,EAHjE;;AAIA,QAAI,CAAC0U,4BAAL,EAAmC;AACjC1K,MAAAA,oBAAoB;AACrB;;AACD,QAAIkD,eAAe,IAAI,CAACA,eAAe,CAAC,CAAD,CAAf,CAAmB/E,MAAnB,CAA0B6E,UAAlD,EAA8D;AAC5DkG,MAAAA,UAAU,CAAChG,eAAD,CAAV;AACD,KAFD,MAEO;AACLmG,MAAAA,UAAU;AACX;AACF,GAnBM,EAoBP,CACEjT,MAAM,CAACuU,SADT,EAEEzB,UAFF,EAGEG,UAHF,EAIEjT,MAJF,EAKEiS,wBALF,EAMErI,oBANF,CApBO,CAAT;AA8BA,QAAM/J,WAAW,GAAG4H,WAAW,CAC7B,SAAS5H,WAAT,GAAuB;AACrB,QAAIG,MAAM,CAACuU,SAAX,EAAsB;AACpB,YAAMC,SAAiB,GAAG;AACxB5U,QAAAA,EAAE,EAAEsM,IAAI,CAACI,KAAL,CAAWJ,IAAI,CAACK,MAAL,KAAgB,IAA3B,CADoB;AACc;AACtCG,QAAAA,QAAQ,EAAE,EAFc;AAGxBE,QAAAA,UAAU,EAAE;AAHY,OAA1B;AAKA,YAAM6H,yBAAyB,GAAG5H,YAAY,CAAC7M,MAAD,EAASwU,SAAT,CAA9C;AACAtC,MAAAA,2BAA2B,CAACuC,yBAAD,CAA3B;AACD;AACF,GAX4B,EAY7B,CAACzU,MAAD,CAZ6B,CAA/B;AAeA,QAAM0J,eAAe,GAAGjC,WAAW,CACjC,SAASiC,eAAT,CAAyB5B,OAAzB,EAA2C;AACzCC,IAAAA,MAAM,CAAE2E,QAAR,CAAiBgI,IAAjB,CAAsB5M,OAAtB;AACA+E,IAAAA,YAAY,CAAC7M,MAAD,EAAS+H,MAAT,CAAZ;AACAmK,IAAAA,2BAA2B,CAAC,IAAD,CAA3B;AACAJ,IAAAA,SAAS,CAAC,IAAD,CAAT;AACD,GANgC,EAOjC,CAAC9R,MAAD,EAAS+H,MAAT,CAPiC,CAAnC;AAUA,SAAO;AACLA,IAAAA,MADK;AAEL4H,IAAAA,QAAQ,EAAEoC,cAFL;AAGLlS,IAAAA,WAHK;AAIL6J,IAAAA,eAJK;AAKLE,IAAAA;AALK,GAAP;AAOD;;;;"}